<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>OrcaROOT: /Users/markhowe/Dev/OrcaRoot/Processors/ORHistWriter.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>/Users/markhowe/Dev/OrcaRoot/Processors/ORHistWriter.cc</h1><a href="_o_r_hist_writer_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// ORHistWriter.cc</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#include "<a class="code" href="_o_r_hist_writer_8hh.html">ORHistWriter.hh</a>"</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="preprocessor">#include "TH2.h"</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include "TH3.h"</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include "<a class="code" href="_o_r_logger_8hh.html">ORLogger.hh</a>"</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="keyword">using namespace </span>std;
<a name="l00010"></a>00010 
<a name="l00011"></a><a class="code" href="class_o_r_hist_writer.html#365e6580f1804d86e97b06f061c01b3b">00011</a> <a class="code" href="class_o_r_hist_writer.html#365e6580f1804d86e97b06f061c01b3b">ORHistWriter::ORHistWriter</a>(<a class="code" href="class_o_r_v_hist_decoder.html">ORVHistDecoder</a>* histDecoder) :
<a name="l00012"></a>00012 <a class="code" href="class_o_r_data_processor.html">ORDataProcessor</a>(histDecoder)
<a name="l00013"></a>00013 {
<a name="l00014"></a>00014   <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a> = histDecoder;
<a name="l00015"></a>00015 }
<a name="l00016"></a>00016 
<a name="l00017"></a><a class="code" href="class_o_r_hist_writer.html#34c61e99baa9724ce90189be1abbd353">00017</a> <a class="code" href="class_o_r_data_processor.html#a59708f9814da2d5e74fc240dd381374">ORDataProcessor::EReturnCode</a> <a class="code" href="class_o_r_hist_writer.html#34c61e99baa9724ce90189be1abbd353">ORHistWriter::StartProcessing</a>()
<a name="l00018"></a>00018 {
<a name="l00019"></a>00019   <span class="keywordflow">if</span>(<a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a> == NULL) {
<a name="l00020"></a>00020     <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kWarning) &lt;&lt; <span class="stringliteral">"StartProcessing(): fHistDecoder was NULL, can't proceed"</span>;
<a name="l00021"></a>00021     <a class="code" href="class_o_r_data_processor.html#077881cda4a1a22d567cb374a6769ab4">KillProcessor</a>();
<a name="l00022"></a>00022     <span class="keywordflow">return</span> <a class="code" href="class_o_r_data_processor.html#a59708f9814da2d5e74fc240dd3813740910274728edc79de10aeaf1dcaa0d9d">kFailure</a>;
<a name="l00023"></a>00023   }
<a name="l00024"></a>00024   <span class="keywordflow">return</span> <a class="code" href="class_o_r_data_processor.html#a59708f9814da2d5e74fc240dd381374e712334150c05cc83d64959c49d05f62">kSuccess</a>;
<a name="l00025"></a>00025 }
<a name="l00026"></a>00026 
<a name="l00027"></a><a class="code" href="class_o_r_hist_writer.html#630a821f52595d0144b4ff3b8f705f48">00027</a> <a class="code" href="class_o_r_data_processor.html#a59708f9814da2d5e74fc240dd381374">ORDataProcessor::EReturnCode</a> <a class="code" href="class_o_r_hist_writer.html#630a821f52595d0144b4ff3b8f705f48">ORHistWriter::StartRun</a>()
<a name="l00028"></a>00028 {
<a name="l00029"></a>00029   map&lt;int, TH1*&gt;::iterator iHist;
<a name="l00030"></a>00030   <span class="keywordflow">for</span> (iHist = <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>.begin(); iHist != <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>.end(); iHist++) {
<a name="l00031"></a>00031     <span class="keywordflow">if</span> (iHist-&gt;second != NULL) iHist-&gt;second-&gt;Reset();
<a name="l00032"></a>00032   }
<a name="l00033"></a>00033  
<a name="l00034"></a>00034   <span class="keywordflow">return</span> <a class="code" href="class_o_r_data_processor.html#a59708f9814da2d5e74fc240dd381374e712334150c05cc83d64959c49d05f62">kSuccess</a>;
<a name="l00035"></a>00035 }
<a name="l00036"></a>00036 
<a name="l00037"></a><a class="code" href="class_o_r_hist_writer.html#800e7b6a6fd82a7eff57f437b41e08a6">00037</a> <a class="code" href="class_o_r_data_processor.html#a59708f9814da2d5e74fc240dd381374">ORDataProcessor::EReturnCode</a> <a class="code" href="class_o_r_hist_writer.html#800e7b6a6fd82a7eff57f437b41e08a6">ORHistWriter::ProcessMyDataRecord</a>(UInt_t* record)
<a name="l00038"></a>00038 {
<a name="l00039"></a>00039   <span class="keywordtype">int</span> iHist = <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#d070a2a93bc6b2f5e097c15a9cd04976">GetHistIndex</a>(record);
<a name="l00040"></a>00040 
<a name="l00041"></a>00041   <span class="comment">// look up in map only once for a typical record</span>
<a name="l00042"></a>00042   TH1* hist = <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>[iHist]; 
<a name="l00043"></a>00043 
<a name="l00044"></a>00044   <span class="keywordflow">if</span>(hist == NULL) {
<a name="l00045"></a>00045     <span class="keywordflow">switch</span>(<a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#83f338d38e4646d31d59c179af55084d">GetNDim</a>()) {
<a name="l00046"></a>00046       <span class="comment">// fHists are owned by parent root file (or gROOT); </span>
<a name="l00047"></a>00047       <span class="comment">// they will be deleted upon fFile-&gt;Close() (or end of program)</span>
<a name="l00048"></a>00048       <span class="keywordflow">case</span> 1:
<a name="l00049"></a>00049         <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>[iHist] = <span class="keyword">new</span> TH1D(
<a name="l00050"></a>00050           <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#5b3c3636f412f075156c38614e88c6f9">GetHistName</a>(iHist).c_str(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#0d3ebfec43e4a038e79c818edd8edd82">GetHistTitle</a>(iHist).c_str(),
<a name="l00051"></a>00051           <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#484f803d79d739cb9df7482b8492381c">GetNbinsX</a>(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#5ff298775a7c3b7699e396f78a94553f">GetXLo</a>(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#10f77b5a414714598fd841397147c698">GetXHi</a>()
<a name="l00052"></a>00052         );
<a name="l00053"></a>00053         <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>[iHist]-&gt;SetXTitle(<a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#d60719b32274b5992f249c4806132cad">GetXTitle</a>().c_str());
<a name="l00054"></a>00054         <span class="keywordflow">break</span>;
<a name="l00055"></a>00055       <span class="keywordflow">case</span> 2:
<a name="l00056"></a>00056         <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>[iHist] = <span class="keyword">new</span> TH2D(
<a name="l00057"></a>00057           <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#5b3c3636f412f075156c38614e88c6f9">GetHistName</a>(iHist).c_str(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#0d3ebfec43e4a038e79c818edd8edd82">GetHistTitle</a>(iHist).c_str(),
<a name="l00058"></a>00058           <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#484f803d79d739cb9df7482b8492381c">GetNbinsX</a>(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#5ff298775a7c3b7699e396f78a94553f">GetXLo</a>(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#10f77b5a414714598fd841397147c698">GetXHi</a>(),
<a name="l00059"></a>00059           <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#55d8a9a99ecf835ff934d686616d258c">GetNbinsY</a>(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#5c709ef4ac619a15181b38e83b8dc906">GetYLo</a>(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#a1d87e077ee5fe5f59b2027aacf0f9ed">GetYHi</a>()
<a name="l00060"></a>00060         );
<a name="l00061"></a>00061         <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>[iHist]-&gt;SetXTitle(<a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#d60719b32274b5992f249c4806132cad">GetXTitle</a>().c_str());
<a name="l00062"></a>00062         <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>[iHist]-&gt;SetYTitle(<a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#fd60e8cb03b297a06d1150dea6bd09f1">GetYTitle</a>().c_str());
<a name="l00063"></a>00063         <span class="keywordflow">break</span>;
<a name="l00064"></a>00064       <span class="keywordflow">case</span> 3:
<a name="l00065"></a>00065         <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>[iHist] = <span class="keyword">new</span> TH3D(
<a name="l00066"></a>00066           <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#5b3c3636f412f075156c38614e88c6f9">GetHistName</a>(iHist).c_str(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#0d3ebfec43e4a038e79c818edd8edd82">GetHistTitle</a>(iHist).c_str(),
<a name="l00067"></a>00067           <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#484f803d79d739cb9df7482b8492381c">GetNbinsX</a>(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#5ff298775a7c3b7699e396f78a94553f">GetXLo</a>(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#10f77b5a414714598fd841397147c698">GetXHi</a>(),
<a name="l00068"></a>00068           <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#55d8a9a99ecf835ff934d686616d258c">GetNbinsY</a>(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#5c709ef4ac619a15181b38e83b8dc906">GetYLo</a>(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#a1d87e077ee5fe5f59b2027aacf0f9ed">GetYHi</a>(),
<a name="l00069"></a>00069           <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#1e62385003a84fbd43ea93612b5204a8">GetNbinsZ</a>(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#4bd29387494ec4462d36cc626dc1209e">GetZLo</a>(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#171c73a7f1f44c315c386bc0f3ea62d3">GetZHi</a>()
<a name="l00070"></a>00070         );
<a name="l00071"></a>00071         <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>[iHist]-&gt;SetXTitle(<a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#d60719b32274b5992f249c4806132cad">GetXTitle</a>().c_str());
<a name="l00072"></a>00072         <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>[iHist]-&gt;SetYTitle(<a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#fd60e8cb03b297a06d1150dea6bd09f1">GetYTitle</a>().c_str());
<a name="l00073"></a>00073         <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>[iHist]-&gt;SetZTitle(<a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#00725304457d3397190f097709ec1329">GetZTitle</a>().c_str());
<a name="l00074"></a>00074         <span class="keywordflow">break</span>;
<a name="l00075"></a>00075       <span class="keywordflow">default</span>:
<a name="l00076"></a>00076         <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kWarning) &lt;&lt; <span class="stringliteral">"ProcessMyDataRecord(): Can't handle more than "</span>
<a name="l00077"></a>00077                         &lt;&lt; <span class="stringliteral">"3 dimensions; using 1..."</span> &lt;&lt; endl;
<a name="l00078"></a>00078         <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>[iHist] = <span class="keyword">new</span> TH1D(
<a name="l00079"></a>00079           <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#5b3c3636f412f075156c38614e88c6f9">GetHistName</a>(iHist).c_str(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#0d3ebfec43e4a038e79c818edd8edd82">GetHistTitle</a>(iHist).c_str(),
<a name="l00080"></a>00080           <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#484f803d79d739cb9df7482b8492381c">GetNbinsX</a>(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#5ff298775a7c3b7699e396f78a94553f">GetXLo</a>(), <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#10f77b5a414714598fd841397147c698">GetXHi</a>()
<a name="l00081"></a>00081         );
<a name="l00082"></a>00082     }
<a name="l00083"></a>00083     hist = <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>[iHist];
<a name="l00084"></a>00084   }
<a name="l00085"></a>00085 
<a name="l00086"></a>00086   <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> iEntry=0; iEntry &lt; <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#ac2ea180f9394dcedd224261ce6c0470">GetNEntries</a>(record); iEntry++) {
<a name="l00087"></a>00087     <span class="keywordflow">switch</span>(<a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#83f338d38e4646d31d59c179af55084d">GetNDim</a>()) {
<a name="l00088"></a>00088       <span class="keywordflow">case</span> 1: 
<a name="l00089"></a>00089         hist-&gt;Fill(<a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#5ca39798669a81c54225261e1b53ad65">GetX</a>(record, iEntry), 
<a name="l00090"></a>00090                    <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#9428e9d5edadf922a9dca73f451a486b">GetWeight</a>(record, iEntry));
<a name="l00091"></a>00091         <span class="keywordflow">break</span>;
<a name="l00092"></a>00092       <span class="keywordflow">case</span> 2: 
<a name="l00093"></a>00093         ((TH2D*) hist)-&gt;Fill(<a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#5ca39798669a81c54225261e1b53ad65">GetX</a>(record, iEntry), 
<a name="l00094"></a>00094                              <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#c58a151a2d1a38af2e180447eaf760c5">GetY</a>(record, iEntry), 
<a name="l00095"></a>00095                              <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#9428e9d5edadf922a9dca73f451a486b">GetWeight</a>(record, iEntry));
<a name="l00096"></a>00096         <span class="keywordflow">break</span>;
<a name="l00097"></a>00097       <span class="keywordflow">case</span> 3: 
<a name="l00098"></a>00098         ((TH3D*) hist)-&gt;Fill(<a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#5ca39798669a81c54225261e1b53ad65">GetX</a>(record, iEntry), 
<a name="l00099"></a>00099                              <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#c58a151a2d1a38af2e180447eaf760c5">GetY</a>(record, iEntry), 
<a name="l00100"></a>00100                              <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#200a9069fa7b41254d8a99c5613eda85">GetZ</a>(record, iEntry),
<a name="l00101"></a>00101                              <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#9428e9d5edadf922a9dca73f451a486b">GetWeight</a>(record, iEntry));
<a name="l00102"></a>00102         <span class="keywordflow">break</span>;
<a name="l00103"></a>00103       <span class="keywordflow">default</span>:
<a name="l00104"></a>00104         hist-&gt;Fill(<a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#5ca39798669a81c54225261e1b53ad65">GetX</a>(record, iEntry), 
<a name="l00105"></a>00105                    <a class="code" href="class_o_r_hist_writer.html#6e2f031a3f8dde54541f670e251ade12">fHistDecoder</a>-&gt;<a class="code" href="class_o_r_v_hist_decoder.html#9428e9d5edadf922a9dca73f451a486b">GetWeight</a>(record, iEntry));
<a name="l00106"></a>00106         <span class="keywordflow">break</span>;
<a name="l00107"></a>00107     }
<a name="l00108"></a>00108   }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110   <span class="keywordflow">return</span> <a class="code" href="class_o_r_data_processor.html#a59708f9814da2d5e74fc240dd381374e712334150c05cc83d64959c49d05f62">kSuccess</a>;
<a name="l00111"></a>00111 }
<a name="l00112"></a>00112 
<a name="l00113"></a><a class="code" href="class_o_r_hist_writer.html#8c01e0eba4c4fe6ebe8bfd52dedc02bf">00113</a> <a class="code" href="class_o_r_data_processor.html#a59708f9814da2d5e74fc240dd381374">ORDataProcessor::EReturnCode</a> <a class="code" href="class_o_r_hist_writer.html#8c01e0eba4c4fe6ebe8bfd52dedc02bf">ORHistWriter::EndRun</a>()
<a name="l00114"></a>00114 {
<a name="l00115"></a>00115   map&lt;int, TH1*&gt;::iterator iHist;
<a name="l00116"></a>00116   <span class="keywordflow">for</span> (iHist = <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>.begin(); iHist != <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>.end(); iHist++) {
<a name="l00117"></a>00117     <span class="keywordflow">if</span> (iHist-&gt;second != NULL) {
<a name="l00118"></a>00118       iHist-&gt;second-&gt;Write();
<a name="l00119"></a>00119       iHist-&gt;second-&gt;Reset();
<a name="l00120"></a>00120     }
<a name="l00121"></a>00121   }
<a name="l00122"></a>00122 
<a name="l00123"></a>00123   <span class="comment">// if a TFile is open, the histos will be deleted by the file. If not,</span>
<a name="l00124"></a>00124   <span class="comment">// gDirectory will be named "Rint", and the histos will remain in memory.</span>
<a name="l00125"></a>00125   <span class="keywordflow">if</span>(<span class="keywordtype">string</span>(gDirectory-&gt;GetName()) != <span class="stringliteral">"Rint"</span>) {
<a name="l00126"></a>00126     <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>.clear();
<a name="l00127"></a>00127   }
<a name="l00128"></a>00128   <span class="keywordflow">return</span> <a class="code" href="class_o_r_data_processor.html#a59708f9814da2d5e74fc240dd381374e712334150c05cc83d64959c49d05f62">kSuccess</a>;
<a name="l00129"></a>00129 }
<a name="l00130"></a>00130 
<a name="l00131"></a><a class="code" href="class_o_r_hist_writer.html#7e26cf08ae9008db3913c417dc6335cb">00131</a> <a class="code" href="class_o_r_data_processor.html#a59708f9814da2d5e74fc240dd381374">ORDataProcessor::EReturnCode</a> <a class="code" href="class_o_r_hist_writer.html#7e26cf08ae9008db3913c417dc6335cb">ORHistWriter::EndProcessing</a>()
<a name="l00132"></a>00132 {
<a name="l00133"></a>00133   <span class="keywordflow">if</span>(<span class="keywordtype">string</span>(gDirectory-&gt;GetName()) != <span class="stringliteral">"Rint"</span>) <span class="keywordflow">return</span> <a class="code" href="class_o_r_data_processor.html#a59708f9814da2d5e74fc240dd381374e712334150c05cc83d64959c49d05f62">kSuccess</a>;
<a name="l00134"></a>00134 
<a name="l00135"></a>00135   map&lt;int, TH1*&gt;::iterator iHist;
<a name="l00136"></a>00136   <span class="keywordflow">for</span> (iHist = <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>.begin(); iHist != <a class="code" href="class_o_r_hist_writer.html#fc2ab276faadf1ca8188e91ad887fdba">fHists</a>.end(); iHist++) {
<a name="l00137"></a>00137     <span class="keyword">delete</span> iHist-&gt;second;
<a name="l00138"></a>00138   }
<a name="l00139"></a>00139   <span class="keywordflow">return</span> <a class="code" href="class_o_r_data_processor.html#a59708f9814da2d5e74fc240dd381374e712334150c05cc83d64959c49d05f62">kSuccess</a>;
<a name="l00140"></a>00140 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed May 13 08:51:18 2009 for OrcaROOT by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
