<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>OrcaROOT: /Users/markhowe/Dev/OrcaRoot/Processors/OROrcaRequestProcessor.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>/Users/markhowe/Dev/OrcaRoot/Processors/OROrcaRequestProcessor.cc</h1><a href="_o_r_orca_request_processor_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// OROrcaRequestProcessor.cc</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#include "<a class="code" href="_o_r_orca_request_processor_8hh.html">OROrcaRequestProcessor.hh</a>"</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include "<a class="code" href="_o_r_debug_request_processor_8hh.html">ORDebugRequestProcessor.hh</a>"</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include "<a class="code" href="_o_r_orca_request_fit_processor_8hh.html">OROrcaRequestFitProcessor.hh</a>"</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include "<a class="code" href="_o_r_orca_request_f_f_t_processor_8hh.html">OROrcaRequestFFTProcessor.hh</a>"</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="preprocessor">#include "TROOT.h"</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include "<a class="code" href="_o_r_logger_8hh.html">ORLogger.hh</a>"</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include "<a class="code" href="_o_r_dictionary_8hh.html">ORDictionary.hh</a>"</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include "<a class="code" href="_o_r_xml_plist_string_8hh.html">ORXmlPlistString.hh</a>"</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include "<a class="code" href="_o_r_utils_8hh.html">ORUtils.hh</a>"</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="keyword">using namespace </span>std;
<a name="l00015"></a>00015 
<a name="l00016"></a><a class="code" href="class_o_r_orca_request_processor.html#1ca19ed4de1526800c9cf42859a942bd">00016</a> <a class="code" href="class_o_r_orca_request_processor.html#1ca19ed4de1526800c9cf42859a942bd">OROrcaRequestProcessor::OROrcaRequestProcessor</a>() : <a class="code" href="class_o_r_data_processor.html">ORDataProcessor</a>(new <a class="code" href="class_o_r_orca_request_decoder.html">OROrcaRequestDecoder</a>)
<a name="l00017"></a>00017 {
<a name="l00018"></a>00018   <a class="code" href="class_o_r_orca_request_processor.html#ba699cdead36abbb9d60a68f45c294dd">fOrcaRequestDecoder</a> = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_o_r_orca_request_decoder.html">OROrcaRequestDecoder</a>*<span class="keyword">&gt;</span>(<a class="code" href="class_o_r_data_processor.html#d451326fca1dc6e68d2b910ca7db5d17">fDataDecoder</a>);
<a name="l00019"></a>00019 }
<a name="l00020"></a>00020 
<a name="l00021"></a><a class="code" href="class_o_r_orca_request_processor.html#15acc7fde75285dcadb81b2f3aa54ce9">00021</a> <a class="code" href="class_o_r_orca_request_processor.html#15acc7fde75285dcadb81b2f3aa54ce9">OROrcaRequestProcessor::~OROrcaRequestProcessor</a>()
<a name="l00022"></a>00022 {
<a name="l00023"></a>00023   <span class="keyword">delete</span> <a class="code" href="class_o_r_orca_request_processor.html#ba699cdead36abbb9d60a68f45c294dd">fOrcaRequestDecoder</a>;
<a name="l00024"></a>00024   std::map&lt;std::string, ORVOrcaRequestProcessor*&gt;::iterator iter = 
<a name="l00025"></a>00025     <a class="code" href="class_o_r_orca_request_processor.html#13648905faf6de0998476ed62ed4823a">fReqProcessorMap</a>.begin();
<a name="l00026"></a>00026   <span class="keywordflow">while</span>(iter != <a class="code" href="class_o_r_orca_request_processor.html#13648905faf6de0998476ed62ed4823a">fReqProcessorMap</a>.end()) {
<a name="l00027"></a>00027     <span class="keyword">delete</span> iter-&gt;second;
<a name="l00028"></a>00028     iter++;
<a name="l00029"></a>00029   }
<a name="l00030"></a>00030 }
<a name="l00031"></a>00031 
<a name="l00032"></a><a class="code" href="class_o_r_orca_request_processor.html#06b1af750d4c6b8cd8c4ff9a3958fa80">00032</a> <span class="keywordtype">bool</span> <a class="code" href="class_o_r_orca_request_processor.html#06b1af750d4c6b8cd8c4ff9a3958fa80">OROrcaRequestProcessor::LoadRequestHandler</a>(<span class="keyword">const</span> std::string&amp; processor)
<a name="l00033"></a>00033 {
<a name="l00034"></a>00034   <span class="comment">// First check to see if the Processor is already in the map.</span>
<a name="l00035"></a>00035   std::map&lt;std::string, ORVOrcaRequestProcessor*&gt;::iterator iter;
<a name="l00036"></a>00036   iter = <a class="code" href="class_o_r_orca_request_processor.html#13648905faf6de0998476ed62ed4823a">fReqProcessorMap</a>.find(processor); 
<a name="l00037"></a>00037   <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kRoutine) &lt;&lt; <span class="stringliteral">"Loading processor: "</span> &lt;&lt; processor &lt;&lt; endl;
<a name="l00038"></a>00038   <span class="keywordflow">if</span>(iter != <a class="code" href="class_o_r_orca_request_processor.html#13648905faf6de0998476ed62ed4823a">fReqProcessorMap</a>.end()) {
<a name="l00039"></a>00039     <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a> = iter-&gt;second;
<a name="l00040"></a>00040     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00041"></a>00041   }
<a name="l00042"></a>00042   <span class="comment">// OK so we have to load it:</span>
<a name="l00043"></a>00043   <span class="keywordflow">if</span>(processor==<span class="stringliteral">"ORDebugRequestProcessor"</span>) {
<a name="l00044"></a>00044     <span class="comment">// load the processor like:</span>
<a name="l00045"></a>00045     <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a> = <span class="keyword">new</span> <a class="code" href="class_o_r_debug_request_processor.html">ORDebugRequestProcessor</a>;
<a name="l00046"></a>00046     <a class="code" href="class_o_r_orca_request_processor.html#13648905faf6de0998476ed62ed4823a">fReqProcessorMap</a>[processor] = <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a>;
<a name="l00047"></a>00047     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00048"></a>00048   }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (processor==<span class="stringliteral">"OROrcaRequestFitProcessor"</span>) {
<a name="l00049"></a>00049     <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a> = <span class="keyword">new</span> <a class="code" href="class_o_r_orca_request_fit_processor.html">OROrcaRequestFitProcessor</a>;
<a name="l00050"></a>00050     <a class="code" href="class_o_r_orca_request_processor.html#13648905faf6de0998476ed62ed4823a">fReqProcessorMap</a>[processor] = <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a>;
<a name="l00051"></a>00051     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00052"></a>00052 <span class="preprocessor">#ifdef ORROOT_HAS_FFTW</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>  }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (processor==<span class="stringliteral">"OROrcaRequestFFTProcessor"</span>) {
<a name="l00054"></a>00054     <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a> = <span class="keyword">new</span> OROrcaRequestFFTProcessor;
<a name="l00055"></a>00055     <a class="code" href="class_o_r_orca_request_processor.html#13648905faf6de0998476ed62ed4823a">fReqProcessorMap</a>[processor] = <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a>;
<a name="l00056"></a>00056     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00057"></a>00057 <span class="preprocessor">#endif</span>
<a name="l00058"></a>00058 <span class="preprocessor"></span>  } <span class="keywordflow">else</span> {
<a name="l00059"></a>00059     <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kError) &lt;&lt; processor &lt;&lt; <span class="stringliteral">" not available. "</span> &lt;&lt; endl;
<a name="l00060"></a>00060     <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a> = NULL;
<a name="l00061"></a>00061     <span class="keywordflow">return</span> <span class="keyword">false</span>; 
<a name="l00062"></a>00062   }
<a name="l00063"></a>00063 }
<a name="l00064"></a>00064 
<a name="l00065"></a><a class="code" href="class_o_r_orca_request_processor.html#abb1423c276b78ca52598b9f6b7079f9">00065</a> <span class="keywordtype">bool</span> <a class="code" href="class_o_r_orca_request_processor.html#abb1423c276b78ca52598b9f6b7079f9">OROrcaRequestProcessor::LoadInputs</a>()
<a name="l00066"></a>00066 {
<a name="l00067"></a>00067   <span class="keyword">const</span> <a class="code" href="class_o_r_dictionary.html" title="True dictionary class.">ORDictionary</a>* inputDict; 
<a name="l00068"></a>00068   <span class="keyword">const</span> std::map&lt; std::string, ORVOrcaReqInputOutput&gt;* mapOfInput; 
<a name="l00069"></a>00069   std::map&lt; std::string, ORVOrcaReqInputOutput&gt;::const_iterator inputIter; 
<a name="l00070"></a>00070   inputDict = <a class="code" href="class_o_r_orca_request_processor.html#ba699cdead36abbb9d60a68f45c294dd">fOrcaRequestDecoder</a>-&gt;<a class="code" href="class_o_r_orca_request_decoder.html#aa4830e3dab6aa7cba2a0eb727921c70">GetRequestInputs</a>();
<a name="l00071"></a>00071   mapOfInput = <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a>-&gt;<a class="code" href="class_o_r_v_orca_request_processor.html#fe13626b937a09281feb06c20a2e8981">GetInputMap</a>();
<a name="l00072"></a>00072   inputIter = mapOfInput-&gt;begin();
<a name="l00073"></a>00073   <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kDebug) &lt;&lt; <span class="stringliteral">"Loading of inputs beginning..."</span> &lt;&lt; endl; 
<a name="l00074"></a>00074   <span class="keywordflow">while</span>(inputIter != mapOfInput-&gt;end()) {
<a name="l00075"></a>00075     <span class="keyword">const</span> <a class="code" href="class_o_r_v_dict_value.html" title="Dictionary type base class.">ORVDictValue</a>* dictVal = inputDict-&gt;<a class="code" href="class_o_r_dictionary.html#66ab432a81175edb6059febef7f4415f">LookUp</a>(inputIter-&gt;first);
<a name="l00076"></a>00076     <span class="keywordflow">if</span>(!dictVal) {
<a name="l00077"></a>00077       <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kError) &lt;&lt; <span class="stringliteral">"Error finding "</span> &lt;&lt; inputIter-&gt;first &lt;&lt; <span class="stringliteral">" in inputs. "</span>
<a name="l00078"></a>00078         &lt;&lt; endl;
<a name="l00079"></a>00079       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00080"></a>00080     }
<a name="l00081"></a>00081     <span class="keywordflow">if</span>(dictVal-&gt;<a class="code" href="class_o_r_v_dict_value.html#8049514ca0204c00b9abd59cbd546e26">GetValueType</a>() == <a class="code" href="class_o_r_v_dict_value.html#2c82df917f1709f6b5d4fe5cbf8690561edc7654d8a3c9d26627fe4337fb6af4">ORVDictValue::kString</a>) {
<a name="l00082"></a>00082       <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kDebug) &lt;&lt; <span class="stringliteral">"Inserting input "</span> &lt;&lt; inputIter-&gt;first &lt;&lt; <span class="stringliteral">" into "</span>
<a name="l00083"></a>00083         &lt;&lt; <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a>-&gt;<a class="code" href="class_o_r_v_orca_request_processor.html#9c402e3d87920940e1e5832fe0158b38">GetNameOfRequestProcessor</a>() &lt;&lt; endl;
<a name="l00084"></a>00084       <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a>-&gt;<a class="code" href="class_o_r_v_orca_request_processor.html#6024aeb37871027d93530bd9ccc843c6">LoadInput</a>(inputIter-&gt;first, 
<a name="l00085"></a>00085         &amp;(dynamic_cast&lt;const ORDictValueS*&gt;(dictVal)-&gt;GetS())); 
<a name="l00086"></a>00086     }
<a name="l00087"></a>00087     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dictVal-&gt;<a class="code" href="class_o_r_v_dict_value.html#8049514ca0204c00b9abd59cbd546e26">GetValueType</a>() == <a class="code" href="class_o_r_v_dict_value.html#2c82df917f1709f6b5d4fe5cbf869056b89c0f566de6d42c5b6377649335cebb">ORVDictValue::kReal</a>) {
<a name="l00088"></a>00088       <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kDebug) &lt;&lt; <span class="stringliteral">"Inserting input "</span> &lt;&lt; inputIter-&gt;first &lt;&lt; <span class="stringliteral">" into "</span>
<a name="l00089"></a>00089         &lt;&lt; <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a>-&gt;<a class="code" href="class_o_r_v_orca_request_processor.html#9c402e3d87920940e1e5832fe0158b38">GetNameOfRequestProcessor</a>() &lt;&lt; endl;
<a name="l00090"></a>00090       <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a>-&gt;<a class="code" href="class_o_r_v_orca_request_processor.html#6024aeb37871027d93530bd9ccc843c6">LoadInput</a>(inputIter-&gt;first, 
<a name="l00091"></a>00091         &amp;(dynamic_cast&lt;const ORDictValueR*&gt;(dictVal)-&gt;GetR())); 
<a name="l00092"></a>00092     }
<a name="l00093"></a>00093     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dictVal-&gt;<a class="code" href="class_o_r_v_dict_value.html#8049514ca0204c00b9abd59cbd546e26">GetValueType</a>() == <a class="code" href="class_o_r_v_dict_value.html#2c82df917f1709f6b5d4fe5cbf8690568072a14e241e38c840180b557fe17e96">ORVDictValue::kInt</a>) {
<a name="l00094"></a>00094       <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kDebug) &lt;&lt; <span class="stringliteral">"Inserting input "</span> &lt;&lt; inputIter-&gt;first &lt;&lt; <span class="stringliteral">" into "</span>
<a name="l00095"></a>00095         &lt;&lt; <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a>-&gt;<a class="code" href="class_o_r_v_orca_request_processor.html#9c402e3d87920940e1e5832fe0158b38">GetNameOfRequestProcessor</a>() &lt;&lt; endl;
<a name="l00096"></a>00096       <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a>-&gt;<a class="code" href="class_o_r_v_orca_request_processor.html#6024aeb37871027d93530bd9ccc843c6">LoadInput</a>(inputIter-&gt;first, 
<a name="l00097"></a>00097         &amp;(dynamic_cast&lt;const ORDictValueI*&gt;(dictVal)-&gt;GetI())); 
<a name="l00098"></a>00098     }
<a name="l00099"></a>00099     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dictVal-&gt;<a class="code" href="class_o_r_v_dict_value.html#8049514ca0204c00b9abd59cbd546e26">GetValueType</a>() == <a class="code" href="class_o_r_v_dict_value.html#2c82df917f1709f6b5d4fe5cbf8690560d434fb3ca7694396bc31b1e51b1d80e">ORVDictValue::kArray</a>) {
<a name="l00100"></a>00100       <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kDebug) &lt;&lt; <span class="stringliteral">"Inserting input "</span> &lt;&lt; inputIter-&gt;first &lt;&lt; <span class="stringliteral">" into "</span>
<a name="l00101"></a>00101         &lt;&lt; <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a>-&gt;<a class="code" href="class_o_r_v_orca_request_processor.html#9c402e3d87920940e1e5832fe0158b38">GetNameOfRequestProcessor</a>() &lt;&lt; endl;
<a name="l00102"></a>00102       <span class="keyword">const</span> <a class="code" href="class_o_r_dict_value_a.html" title="Dictionary value for array.">ORDictValueA</a>* dictArray = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_o_r_dict_value_a.html" title="Dictionary value for array.">ORDictValueA</a>*<span class="keyword">&gt;</span>(dictVal);
<a name="l00103"></a>00103       <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a>-&gt;<a class="code" href="class_o_r_v_orca_request_processor.html#6024aeb37871027d93530bd9ccc843c6">LoadInput</a>(inputIter-&gt;first, dictArray);
<a name="l00104"></a>00104     } <span class="keywordflow">else</span> {
<a name="l00105"></a>00105       <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kError) &lt;&lt; <span class="stringliteral">"Incorrect type read in for: "</span> &lt;&lt; inputIter-&gt;first 
<a name="l00106"></a>00106         &lt;&lt; endl;
<a name="l00107"></a>00107       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00108"></a>00108     }
<a name="l00109"></a>00109     
<a name="l00110"></a>00110     inputIter++;
<a name="l00111"></a>00111   }
<a name="l00112"></a>00112   <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kDebug) &lt;&lt; <span class="stringliteral">"Loading of inputs complete."</span> &lt;&lt; endl; 
<a name="l00113"></a>00113   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00114"></a>00114 }
<a name="l00115"></a>00115 
<a name="l00116"></a><a class="code" href="class_o_r_orca_request_processor.html#4c5fd4ee1df26ba089b4f59752384c02">00116</a> <span class="keywordtype">bool</span> <a class="code" href="class_o_r_orca_request_processor.html#4c5fd4ee1df26ba089b4f59752384c02">OROrcaRequestProcessor::ExecuteProcess</a>()
<a name="l00117"></a>00117 {
<a name="l00118"></a>00118   <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kRoutine) &lt;&lt; <span class="stringliteral">"Beginning Process execution... "</span> &lt;&lt; endl;
<a name="l00119"></a>00119   <span class="keywordtype">bool</span> tmpBool = <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a>-&gt;<a class="code" href="class_o_r_v_orca_request_processor.html#5de03163d4496d0a65db9d51a93a364b">ExecuteProcess</a>(); 
<a name="l00120"></a>00120   <span class="keywordflow">if</span>(tmpBool) <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kRoutine) &lt;&lt; <span class="stringliteral">"Process execution complete... "</span> &lt;&lt; endl;
<a name="l00121"></a>00121   <span class="keywordflow">else</span> <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kError) &lt;&lt; <span class="stringliteral">"Process execution failed... "</span> &lt;&lt; endl;
<a name="l00122"></a>00122   <span class="keywordflow">return</span> tmpBool; 
<a name="l00123"></a>00123 }
<a name="l00124"></a>00124 
<a name="l00125"></a><a class="code" href="class_o_r_orca_request_processor.html#1e56d45e93589ad39a7d19b7fef45b57">00125</a> <span class="keywordtype">bool</span> <a class="code" href="class_o_r_orca_request_processor.html#1e56d45e93589ad39a7d19b7fef45b57">OROrcaRequestProcessor::LoadOutputs</a>()
<a name="l00126"></a>00126 {
<a name="l00127"></a>00127   <span class="comment">/* A lot of copying happens here and this is mainly to keep the interface clean.</span>
<a name="l00128"></a>00128 <span class="comment">   * It could be done more quickly, but we're not as concerned about speed for the</span>
<a name="l00129"></a>00129 <span class="comment">   * Orca Socket. We have to assemble the output into a dictionary. */</span>
<a name="l00130"></a>00130   <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kDebug) &lt;&lt; <span class="stringliteral">"Getting outputs to submit to Orca..."</span> &lt;&lt; endl;
<a name="l00131"></a>00131   <span class="keyword">const</span> std::map&lt; std::string, ORVOrcaReqInputOutput&gt;* mapOfOutput; 
<a name="l00132"></a>00132   std::map&lt; std::string, ORVOrcaReqInputOutput&gt;::const_iterator mapOfOutputIter; 
<a name="l00133"></a>00133   mapOfOutput = <a class="code" href="class_o_r_orca_request_processor.html#da95440e6702983a6772e7c6850e7dab">fCurrentReqProcessor</a>-&gt;<a class="code" href="class_o_r_v_orca_request_processor.html#53eb51c53f60e906980a7ba7d53135db">GetOutputMap</a>();
<a name="l00134"></a>00134   
<a name="l00135"></a>00135   <span class="comment">/* We need to now set up the output into ORDictionaries. */</span>
<a name="l00136"></a>00136   <span class="comment">/* Memory management is handled by ORDictionary itself. */</span> 
<a name="l00137"></a>00137   <a class="code" href="class_o_r_dictionary.html" title="True dictionary class.">ORDictionary</a> rootOutputDict(<span class="stringliteral">"OrcaRequestOutput"</span>);
<a name="l00138"></a>00138   rootOutputDict.<a class="code" href="class_o_r_dictionary.html#45646f078a0c9d1af2ef55b473d89416">LoadEntry</a>(<span class="stringliteral">"Request Tag Number"</span>, 
<a name="l00139"></a>00139     <span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_i.html" title="Dictionary value for integer.">ORDictValueI</a>(<a class="code" href="class_o_r_orca_request_processor.html#ba699cdead36abbb9d60a68f45c294dd">fOrcaRequestDecoder</a>-&gt;<a class="code" href="class_o_r_orca_request_decoder.html#ca31e11b79be2e127e2875a5095a1c44">GetRequestTag</a>()));
<a name="l00140"></a>00140   rootOutputDict.<a class="code" href="class_o_r_dictionary.html#45646f078a0c9d1af2ef55b473d89416">LoadEntry</a>(<span class="stringliteral">"Request Option"</span>,
<a name="l00141"></a>00141     <span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_s.html" title="Dictionary value for string.">ORDictValueS</a>(<a class="code" href="class_o_r_orca_request_processor.html#ba699cdead36abbb9d60a68f45c294dd">fOrcaRequestDecoder</a>-&gt;<a class="code" href="class_o_r_orca_request_decoder.html#539000997f3a1d936c4628ad4a8d69d7">GetRequestOption</a>()));
<a name="l00142"></a>00142   rootOutputDict.<a class="code" href="class_o_r_dictionary.html#45646f078a0c9d1af2ef55b473d89416">LoadEntry</a>(<span class="stringliteral">"Request Type"</span>,
<a name="l00143"></a>00143     <span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_s.html" title="Dictionary value for string.">ORDictValueS</a>(<a class="code" href="class_o_r_orca_request_processor.html#ba699cdead36abbb9d60a68f45c294dd">fOrcaRequestDecoder</a>-&gt;<a class="code" href="class_o_r_orca_request_decoder.html#3b901194b653e617ee575c38a2bf1f7c">GetRequestType</a>()));
<a name="l00144"></a>00144   <a class="code" href="class_o_r_dictionary.html" title="True dictionary class.">ORDictionary</a>* outputDict = <span class="keyword">new</span> <a class="code" href="class_o_r_dictionary.html" title="True dictionary class.">ORDictionary</a>(<span class="stringliteral">"Request Outputs"</span>); 
<a name="l00145"></a>00145   
<a name="l00146"></a>00146   <span class="comment">/* now loading in the output. */</span>
<a name="l00147"></a>00147   <span class="keywordflow">for</span>(mapOfOutputIter=mapOfOutput-&gt;begin();
<a name="l00148"></a>00148     mapOfOutputIter!=mapOfOutput-&gt;end();mapOfOutputIter++) {
<a name="l00149"></a>00149     <a class="code" href="class_o_r_v_orca_request_processor.html#ea4f3b354070035ddf467c90414e9ce5">ORVOrcaRequestProcessor::EORVOrcaRequestProcessorConsts</a> theType = 
<a name="l00150"></a>00150       mapOfOutputIter-&gt;second.type;
<a name="l00151"></a>00151     <a class="code" href="class_o_r_v_dict_value.html" title="Dictionary type base class.">ORVDictValue</a>* inputDictValue = NULL;
<a name="l00152"></a>00152     <span class="keywordflow">switch</span> (theType) {
<a name="l00153"></a>00153       <span class="keywordflow">case</span> <a class="code" href="class_o_r_v_orca_request_processor.html#ea4f3b354070035ddf467c90414e9ce56186d20be0e16b8b1199fadaba9e65c5">ORVOrcaRequestProcessor::kString</a>: {
<a name="l00154"></a>00154           inputDictValue = 
<a name="l00155"></a>00155             <span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_s.html" title="Dictionary value for string.">ORDictValueS</a>(*(std::string*)mapOfOutputIter-&gt;second.varAddress); 
<a name="l00156"></a>00156         }
<a name="l00157"></a>00157         <span class="keywordflow">break</span>;
<a name="l00158"></a>00158       <span class="keywordflow">case</span> <a class="code" href="class_o_r_v_orca_request_processor.html#ea4f3b354070035ddf467c90414e9ce5ca1b5f23f1bff9ed6191344c80493d7b">ORVOrcaRequestProcessor::kInt</a>: {
<a name="l00159"></a>00159           inputDictValue = 
<a name="l00160"></a>00160             <span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_i.html" title="Dictionary value for integer.">ORDictValueI</a>(*(<span class="keywordtype">int</span>*)mapOfOutputIter-&gt;second.varAddress); 
<a name="l00161"></a>00161         }
<a name="l00162"></a>00162         <span class="keywordflow">break</span>;
<a name="l00163"></a>00163       <span class="keywordflow">case</span> <a class="code" href="class_o_r_v_orca_request_processor.html#ea4f3b354070035ddf467c90414e9ce5e6df9ef4da6ff845d54cde0177d0a5c9">ORVOrcaRequestProcessor::kReal</a>: {
<a name="l00164"></a>00164           inputDictValue = 
<a name="l00165"></a>00165             <span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_r.html" title="Dictionary value for double.">ORDictValueR</a>(*(<span class="keywordtype">double</span>*)mapOfOutputIter-&gt;second.varAddress); 
<a name="l00166"></a>00166         }
<a name="l00167"></a>00167         <span class="keywordflow">break</span>;
<a name="l00168"></a>00168       <span class="keywordflow">case</span> <a class="code" href="class_o_r_v_orca_request_processor.html#ea4f3b354070035ddf467c90414e9ce550768cd5889943e8b8f3e209a7a9211c">ORVOrcaRequestProcessor::kStringVec</a>: {
<a name="l00169"></a>00169           inputDictValue = <span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_a.html" title="Dictionary value for array.">ORDictValueA</a>(); 
<a name="l00170"></a>00170           std::vector&lt;std::string&gt;* vecS = 
<a name="l00171"></a>00171             (std::vector&lt;std::string&gt;*)mapOfOutputIter-&gt;second.varAddress; 
<a name="l00172"></a>00172           <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0;i&lt;vecS-&gt;size();i++) {
<a name="l00173"></a>00173             ((<a class="code" href="class_o_r_dict_value_a.html" title="Dictionary value for array.">ORDictValueA</a>*)inputDictValue)-&gt;LoadValue(<span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_s.html" title="Dictionary value for string.">ORDictValueS</a>((*vecS)[i]));
<a name="l00174"></a>00174           }
<a name="l00175"></a>00175         }
<a name="l00176"></a>00176         <span class="keywordflow">break</span>;
<a name="l00177"></a>00177       <span class="keywordflow">case</span> <a class="code" href="class_o_r_v_orca_request_processor.html#ea4f3b354070035ddf467c90414e9ce5388ce823e6bde678516fcf1d0ddf9092">ORVOrcaRequestProcessor::kIntVec</a>: {
<a name="l00178"></a>00178           inputDictValue = <span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_a.html" title="Dictionary value for array.">ORDictValueA</a>(); 
<a name="l00179"></a>00179           std::vector&lt;int&gt;* vecI = 
<a name="l00180"></a>00180             (std::vector&lt;int&gt;*)mapOfOutputIter-&gt;second.varAddress; 
<a name="l00181"></a>00181           <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0;i&lt;vecI-&gt;size();i++) {
<a name="l00182"></a>00182             ((<a class="code" href="class_o_r_dict_value_a.html" title="Dictionary value for array.">ORDictValueA</a>*)inputDictValue)-&gt;LoadValue(<span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_i.html" title="Dictionary value for integer.">ORDictValueI</a>((*vecI)[i]));
<a name="l00183"></a>00183           }
<a name="l00184"></a>00184         }
<a name="l00185"></a>00185         <span class="keywordflow">break</span>;
<a name="l00186"></a>00186       <span class="keywordflow">case</span> <a class="code" href="class_o_r_v_orca_request_processor.html#ea4f3b354070035ddf467c90414e9ce5806440c475cb6fe1602e679788ae3f41">ORVOrcaRequestProcessor::kRealVec</a>: {
<a name="l00187"></a>00187           inputDictValue = <span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_a.html" title="Dictionary value for array.">ORDictValueA</a>(); 
<a name="l00188"></a>00188           std::vector&lt;double&gt;* vecR = 
<a name="l00189"></a>00189             (std::vector&lt;double&gt;*)mapOfOutputIter-&gt;second.varAddress; 
<a name="l00190"></a>00190           <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0;i&lt;vecR-&gt;size();i++) {
<a name="l00191"></a>00191             ((<a class="code" href="class_o_r_dict_value_a.html" title="Dictionary value for array.">ORDictValueA</a>*)inputDictValue)-&gt;LoadValue(<span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_r.html" title="Dictionary value for double.">ORDictValueR</a>((*vecR)[i]));
<a name="l00192"></a>00192           }
<a name="l00193"></a>00193         }
<a name="l00194"></a>00194         <span class="keywordflow">break</span>;
<a name="l00195"></a>00195     }
<a name="l00196"></a>00196     outputDict-&gt;<a class="code" href="class_o_r_dictionary.html#45646f078a0c9d1af2ef55b473d89416">LoadEntry</a>(mapOfOutputIter-&gt;first, inputDictValue);  
<a name="l00197"></a>00197 
<a name="l00198"></a>00198   }
<a name="l00199"></a>00199   rootOutputDict.<a class="code" href="class_o_r_dictionary.html#45646f078a0c9d1af2ef55b473d89416">LoadEntry</a>(outputDict-&gt;<a class="code" href="class_o_r_dictionary.html#006daa27fe4d2905610b1ff2001de434">GetName</a>(), outputDict);
<a name="l00200"></a>00200   <a class="code" href="class_o_r_xml_plist_string.html">ORXmlPlistString</a> xmlOutput; 
<a name="l00201"></a>00201   xmlOutput.<a class="code" href="class_o_r_xml_plist_string.html#02d220d9c8ecc4dcc0e5d83713cf3402" title="/* Load a dictionary into the string as a plist */">LoadDictionary</a>(&amp;rootOutputDict);
<a name="l00202"></a>00202  
<a name="l00203"></a>00203   <span class="comment">/* Now send along the xml list back to orca */</span> 
<a name="l00204"></a>00204   <span class="keywordflow">if</span> (!<a class="code" href="class_o_r_data_processor.html#0c2f18fedd7550143ca79c54d042535c">fRunContext</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00205"></a>00205   <span class="comment">/* The data id is gotten and or-ed with the length to resend </span>
<a name="l00206"></a>00206 <span class="comment">   * as the first word.  Dataid's are only in the upper 16 bits</span>
<a name="l00207"></a>00207 <span class="comment">   * of the 32 bit word. The length is in number of 4-byte words.*/</span>
<a name="l00208"></a>00208   <span class="keywordflow">while</span>(xmlOutput.length() % <span class="keyword">sizeof</span>(UInt_t) != 0) xmlOutput.append(<span class="stringliteral">" "</span>);
<a name="l00209"></a>00209   UInt_t dataIdToResend = <a class="code" href="class_o_r_orca_request_processor.html#ba699cdead36abbb9d60a68f45c294dd">fOrcaRequestDecoder</a>-&gt;<a class="code" href="class_o_r_orca_request_decoder.html#b2851a355a19521a73936572f2ff03fc">GetDataId</a>();
<a name="l00210"></a>00210   dataIdToResend |= xmlOutput.length()/<span class="keyword">sizeof</span>(UInt_t) + 1;
<a name="l00211"></a>00211  
<a name="l00212"></a>00212   <span class="keywordflow">if</span>(<a class="code" href="class_o_r_data_processor.html#0c2f18fedd7550143ca79c54d042535c">fRunContext</a>-&gt;<a class="code" href="class_o_r_run_context.html#2e24c5562c235e229e8df4b9903ebe1b">MustSwap</a>()) <a class="code" href="namespace_o_r_utils.html#8eb48f112a74710383098b5bad8214f1">ORUtils::Swap</a>(dataIdToResend);
<a name="l00213"></a>00213   <span class="comment">/* We have to swap the binary, but not the char data*/</span>
<a name="l00214"></a>00214   
<a name="l00215"></a>00215   <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kDebug) &lt;&lt; <span class="stringliteral">"Submitting outputs back to Orca..."</span> &lt;&lt; endl;
<a name="l00216"></a>00216 
<a name="l00217"></a>00217   <span class="keywordtype">int</span> nBytesRead = <a class="code" href="class_o_r_data_processor.html#0c2f18fedd7550143ca79c54d042535c">fRunContext</a>-&gt;<a class="code" href="class_o_r_run_context.html#094f883a5e1edfa2a167d2ab4b8257d5">WriteBackToSocket</a>(&amp;dataIdToResend, <span class="keyword">sizeof</span>(dataIdToResend));
<a name="l00218"></a>00218   <span class="keywordflow">if</span>(nBytesRead==<span class="keyword">sizeof</span>(dataIdToResend)) {
<a name="l00219"></a>00219     nBytesRead = <a class="code" href="class_o_r_data_processor.html#0c2f18fedd7550143ca79c54d042535c">fRunContext</a>-&gt;<a class="code" href="class_o_r_run_context.html#094f883a5e1edfa2a167d2ab4b8257d5">WriteBackToSocket</a>(xmlOutput.c_str(), xmlOutput.length());
<a name="l00220"></a>00220     <span class="keywordflow">if</span>(nBytesRead &lt;= 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00221"></a>00221     <span class="keywordflow">else</span> <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00222"></a>00222   } <span class="keywordflow">else</span> {    
<a name="l00223"></a>00223     <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kError) &lt;&lt; <span class="stringliteral">"No socket found to write back on.  Was this header read in as a file?"</span> &lt;&lt; endl; 
<a name="l00224"></a>00224     <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kDebug) &lt;&lt; <span class="stringliteral">"Outputting xml: "</span> &lt;&lt; endl &lt;&lt; xmlOutput &lt;&lt; endl;
<a name="l00225"></a>00225     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00226"></a>00226   }
<a name="l00227"></a>00227 
<a name="l00228"></a>00228 }
<a name="l00229"></a>00229 
<a name="l00230"></a><a class="code" href="class_o_r_orca_request_processor.html#c384105f276c9cdd9b24eb982f3f5c49">00230</a> <span class="keywordtype">void</span> <a class="code" href="class_o_r_orca_request_processor.html#c384105f276c9cdd9b24eb982f3f5c49">OROrcaRequestProcessor::SendErrorToOrca</a>()
<a name="l00231"></a>00231 {
<a name="l00232"></a>00232   <span class="comment">/* Send an error to Orca since something went wrong. */</span>
<a name="l00233"></a>00233   <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kDebug) &lt;&lt; <span class="stringliteral">"Sending error tag back to Orca."</span> &lt;&lt; endl;
<a name="l00234"></a>00234   <a class="code" href="class_o_r_dictionary.html" title="True dictionary class.">ORDictionary</a> rootErrorDict(<span class="stringliteral">"OrcaRequestOutput"</span>);
<a name="l00235"></a>00235   rootErrorDict.<a class="code" href="class_o_r_dictionary.html#45646f078a0c9d1af2ef55b473d89416">LoadEntry</a>(<span class="stringliteral">"Request Tag Number"</span>, 
<a name="l00236"></a>00236     <span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_i.html" title="Dictionary value for integer.">ORDictValueI</a>(<a class="code" href="class_o_r_orca_request_processor.html#ba699cdead36abbb9d60a68f45c294dd">fOrcaRequestDecoder</a>-&gt;<a class="code" href="class_o_r_orca_request_decoder.html#ca31e11b79be2e127e2875a5095a1c44">GetRequestTag</a>()));
<a name="l00237"></a>00237   rootErrorDict.<a class="code" href="class_o_r_dictionary.html#45646f078a0c9d1af2ef55b473d89416">LoadEntry</a>(<span class="stringliteral">"Request Option"</span>,
<a name="l00238"></a>00238     <span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_s.html" title="Dictionary value for string.">ORDictValueS</a>(<a class="code" href="class_o_r_orca_request_processor.html#ba699cdead36abbb9d60a68f45c294dd">fOrcaRequestDecoder</a>-&gt;<a class="code" href="class_o_r_orca_request_decoder.html#539000997f3a1d936c4628ad4a8d69d7">GetRequestOption</a>()));
<a name="l00239"></a>00239   rootErrorDict.<a class="code" href="class_o_r_dictionary.html#45646f078a0c9d1af2ef55b473d89416">LoadEntry</a>(<span class="stringliteral">"Request Type"</span>,
<a name="l00240"></a>00240     <span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_s.html" title="Dictionary value for string.">ORDictValueS</a>(<a class="code" href="class_o_r_orca_request_processor.html#ba699cdead36abbb9d60a68f45c294dd">fOrcaRequestDecoder</a>-&gt;<a class="code" href="class_o_r_orca_request_decoder.html#3b901194b653e617ee575c38a2bf1f7c">GetRequestType</a>()));
<a name="l00241"></a>00241 
<a name="l00242"></a>00242   rootErrorDict.<a class="code" href="class_o_r_dictionary.html#45646f078a0c9d1af2ef55b473d89416">LoadEntry</a>(<span class="stringliteral">"Request Error"</span>, <span class="keyword">new</span> <a class="code" href="class_o_r_dict_value_s.html" title="Dictionary value for string.">ORDictValueS</a>(<span class="stringliteral">"Error"</span>));
<a name="l00243"></a>00243   <a class="code" href="class_o_r_xml_plist_string.html">ORXmlPlistString</a> xmlOutput; 
<a name="l00244"></a>00244   xmlOutput.<a class="code" href="class_o_r_xml_plist_string.html#02d220d9c8ecc4dcc0e5d83713cf3402" title="/* Load a dictionary into the string as a plist */">LoadDictionary</a>(&amp;rootErrorDict);
<a name="l00245"></a>00245   <span class="keywordflow">if</span> (!<a class="code" href="class_o_r_data_processor.html#0c2f18fedd7550143ca79c54d042535c">fRunContext</a>) <span class="keywordflow">return</span>;
<a name="l00246"></a>00246   <span class="comment">/* The data id is gotten and or-ed with the length to resend </span>
<a name="l00247"></a>00247 <span class="comment">   * as the first word.  Dataid's are only in the upper 16 bits</span>
<a name="l00248"></a>00248 <span class="comment">   * of the 32 bit word. The length is in number of 4-byte words.*/</span>
<a name="l00249"></a>00249   <span class="keywordflow">while</span>(xmlOutput.length() % <span class="keyword">sizeof</span>(UInt_t) != 0) xmlOutput.append(<span class="stringliteral">" "</span>);
<a name="l00250"></a>00250   UInt_t dataIdToResend = <a class="code" href="class_o_r_orca_request_processor.html#ba699cdead36abbb9d60a68f45c294dd">fOrcaRequestDecoder</a>-&gt;<a class="code" href="class_o_r_orca_request_decoder.html#b2851a355a19521a73936572f2ff03fc">GetDataId</a>();
<a name="l00251"></a>00251   dataIdToResend |= xmlOutput.length()/<span class="keyword">sizeof</span>(UInt_t) + 1;
<a name="l00252"></a>00252   <span class="keywordflow">if</span>(<a class="code" href="class_o_r_data_processor.html#0c2f18fedd7550143ca79c54d042535c">fRunContext</a>-&gt;<a class="code" href="class_o_r_run_context.html#2e24c5562c235e229e8df4b9903ebe1b">MustSwap</a>()) <a class="code" href="namespace_o_r_utils.html#8eb48f112a74710383098b5bad8214f1">ORUtils::Swap</a>(dataIdToResend);
<a name="l00253"></a>00253   <span class="comment">/* We have to swap the binary, but not the char data*/</span>
<a name="l00254"></a>00254 
<a name="l00255"></a>00255   <span class="keywordtype">int</span> nBytesRead = <a class="code" href="class_o_r_data_processor.html#0c2f18fedd7550143ca79c54d042535c">fRunContext</a>-&gt;<a class="code" href="class_o_r_run_context.html#094f883a5e1edfa2a167d2ab4b8257d5">WriteBackToSocket</a>(&amp;dataIdToResend, <span class="keyword">sizeof</span>(dataIdToResend));
<a name="l00256"></a>00256   <span class="keywordflow">if</span> (nBytesRead &lt;= 0 ) { 
<a name="l00257"></a>00257     <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kError) &lt;&lt; <span class="stringliteral">"No socket found to write back on.  Was this header read in as a file?"</span> &lt;&lt; endl; 
<a name="l00258"></a>00258     <a class="code" href="_o_r_logger_8hh.html#e2c36da87baa0b1075d3c33e9d5f1df8">ORLog</a>(kDebug) &lt;&lt; <span class="stringliteral">"Outputting xml: "</span> &lt;&lt; endl &lt;&lt; xmlOutput &lt;&lt; endl;
<a name="l00259"></a>00259     <span class="keywordflow">return</span>;
<a name="l00260"></a>00260   }
<a name="l00261"></a>00261   <a class="code" href="class_o_r_data_processor.html#0c2f18fedd7550143ca79c54d042535c">fRunContext</a>-&gt;<a class="code" href="class_o_r_run_context.html#094f883a5e1edfa2a167d2ab4b8257d5">WriteBackToSocket</a>(xmlOutput.c_str(), xmlOutput.length());
<a name="l00262"></a>00262 }
<a name="l00263"></a>00263 
<a name="l00264"></a><a class="code" href="class_o_r_orca_request_processor.html#145ed7b051ad3a6150a5128c9465b33e">00264</a> <span class="keywordtype">bool</span> <a class="code" href="class_o_r_orca_request_processor.html#145ed7b051ad3a6150a5128c9465b33e">OROrcaRequestProcessor::ExecuteAll</a>(UInt_t* record)
<a name="l00265"></a>00265 {
<a name="l00266"></a>00266   <span class="keywordflow">if</span>(!<a class="code" href="class_o_r_orca_request_processor.html#ba699cdead36abbb9d60a68f45c294dd">fOrcaRequestDecoder</a>-&gt;<a class="code" href="class_o_r_orca_request_decoder.html#589b727cd6069bbcbc963d114430fb37">ParseDataRecord</a>(record)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00267"></a>00267   <span class="keywordflow">if</span>(!<a class="code" href="class_o_r_orca_request_processor.html#06b1af750d4c6b8cd8c4ff9a3958fa80">LoadRequestHandler</a>(<a class="code" href="class_o_r_orca_request_processor.html#ba699cdead36abbb9d60a68f45c294dd">fOrcaRequestDecoder</a>-&gt;<a class="code" href="class_o_r_orca_request_decoder.html#3b901194b653e617ee575c38a2bf1f7c">GetRequestType</a>())) <span class="keywordflow">return</span> <span class="keyword">false</span>; 
<a name="l00268"></a>00268   <span class="keywordflow">if</span>(!<a class="code" href="class_o_r_orca_request_processor.html#abb1423c276b78ca52598b9f6b7079f9">LoadInputs</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00269"></a>00269   <span class="keywordflow">if</span>(!<a class="code" href="class_o_r_orca_request_processor.html#4c5fd4ee1df26ba089b4f59752384c02">ExecuteProcess</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00270"></a>00270   <span class="keywordflow">if</span>(!<a class="code" href="class_o_r_orca_request_processor.html#1e56d45e93589ad39a7d19b7fef45b57">LoadOutputs</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00271"></a>00271   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00272"></a>00272 }
<a name="l00273"></a>00273 
<a name="l00274"></a><a class="code" href="class_o_r_orca_request_processor.html#4508f7f6abe1150eb6fcad9095639d03">00274</a> <a class="code" href="class_o_r_data_processor.html#a59708f9814da2d5e74fc240dd381374">ORDataProcessor::EReturnCode</a> <a class="code" href="class_o_r_orca_request_processor.html#4508f7f6abe1150eb6fcad9095639d03">OROrcaRequestProcessor::ProcessMyDataRecord</a>(UInt_t* record)
<a name="l00275"></a>00275 {
<a name="l00276"></a>00276   <span class="keywordflow">if</span>(!<a class="code" href="class_o_r_orca_request_processor.html#145ed7b051ad3a6150a5128c9465b33e">ExecuteAll</a>(record)) {
<a name="l00277"></a>00277     <a class="code" href="class_o_r_orca_request_processor.html#c384105f276c9cdd9b24eb982f3f5c49">SendErrorToOrca</a>();
<a name="l00278"></a>00278     <span class="keywordflow">return</span> <a class="code" href="class_o_r_data_processor.html#a59708f9814da2d5e74fc240dd3813740910274728edc79de10aeaf1dcaa0d9d">kFailure</a>;
<a name="l00279"></a>00279   } <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="class_o_r_data_processor.html#a59708f9814da2d5e74fc240dd381374e712334150c05cc83d64959c49d05f62">kSuccess</a>;
<a name="l00280"></a>00280 }
<a name="l00281"></a>00281 
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed May 13 08:51:18 2009 for OrcaROOT by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
