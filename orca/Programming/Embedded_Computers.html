<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="Generator" content="iWeb 3.0.2" />
    <meta name="iWeb-Build" content="local-build-20150109" />
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
    <meta name="viewport" content="width=700" />
    <title>Embedded Computers</title>
    <link rel="stylesheet" type="text/css" media="screen,print" href="Embedded_Computers_files/Embedded_Computers.css" />
    <!--[if lt IE 8]><link rel='stylesheet' type='text/css' media='screen,print' href='Embedded_Computers_files/Embedded_ComputersIE.css'/><![endif]-->
    <!--[if gte IE 8]><link rel='stylesheet' type='text/css' media='screen,print' href='Media/IE8.css'/><![endif]-->
    <script type="text/javascript" src="Scripts/iWebSite.js"></script>
    <script type="text/javascript" src="Scripts/Widgets/SharedResources/WidgetCommon.js"></script>
    <script type="text/javascript" src="Scripts/Widgets/Navbar/navbar.js"></script>
    <script type="text/javascript" src="Scripts/iWebImage.js"></script>
    <script type="text/javascript" src="Embedded_Computers_files/Embedded_Computers.js"></script>
  </head>
  <body style="background: rgb(255, 255, 255); margin: 0pt; " onload="onPageLoad();" onunload="onPageUnload();">
    <div style="text-align: center; ">
      <div style="margin-bottom: 0px; margin-left: auto; margin-right: auto; margin-top: 0px; overflow: hidden; position: relative; word-wrap: break-word;  background: transparent; text-align: left; width: 700px; " id="body_content">
        <div style="margin-left: 0px; position: relative; width: 700px; z-index: 0; " id="nav_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
          <div class="com-apple-iweb-widget-navbar flowDefining" id="widget0" style="margin-left: 35px; margin-top: 0px; opacity: 1.00; position: relative; width: 630px; z-index: 1; ">
    
            <div id="widget0-navbar" class="navbar">

      
              <div id="widget0-bg" class="navbar-bg">

        
                <ul id="widget0-navbar-list" class="navbar-list">
 <li></li> 
</ul>
                
      
</div>
              
    
</div>
          </div>
          <script type="text/javascript"><!--//--><![CDATA[//><!--
new NavBar('widget0', 'Scripts/Widgets/Navbar', 'Scripts/Widgets/SharedResources', '.', {"path-to-root": "", "navbar-css": ".navbar {\n\tfont-family: Arial, sans-serif;\n\tfont-size: 1em;\n\tcolor: #666;\n\tmargin: 9px 0px 6px 0px;\n\tline-height: 30px;\n}\n\n.navbar-bg {\n\ttext-align: center;\n}\n\n.navbar-bg ul {\n\tlist-style: none;\n\tmargin: 0px;\n\tpadding: 0px;\n}\n\n\nli {\n\tlist-style-type: none;\n\tdisplay: inline;\n\tpadding: 0px 10px 0px 10px;\n}\n\n\nli a {\n\ttext-decoration: none;\n\tcolor: #666;\n}\n\nli a:visited {\n\ttext-decoration: none;\n\tcolor: #666;\n}\n\nli a:hover\r{\r\n \tcolor: #463C3C;\n\ttext-decoration: none;\r}\n\n\nli.current-page a\r{\r\t color: #463C3C;\n\ttext-decoration: none;\n\tfont-weight: bold;\r\r}", "current-page-GUID": "BC4712C8-A1E0-4789-9AF9-B9B2A1C926B8", "isCollectionPage": "NO"});
//--><!]]></script>
          <div style="clear: both; height: 0px; line-height: 0px; " class="spacer"> </div>
        </div>
        <div style="height: 73px; margin-left: 0px; position: relative; width: 700px; z-index: 10; " id="header_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
          <div id="id1" style="height: 50px; left: 35px; position: absolute; top: 23px; width: 630px; z-index: 1; " class="style_SkipStroke shape-with-text">
            <div class="text-content style_External_630_50" style="padding: 0px; ">
              <div class="style">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="Header">Embedded Computers</p>
              </div>
            </div>
          </div>
          


          <div style="height: 1px; width: 630px;  height: 1px; left: 35px; position: absolute; top: 3px; width: 630px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 630px; ">
              <img src="Embedded_Computers_files/shapeimage_1.jpg" alt="" style="height: 1px; left: 0px; position: absolute; top: 0px; width: 630px; " />
            </div>
          </div>
        </div>
        <div style="margin-left: 0px; position: relative; width: 700px; z-index: 5; " id="body_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
          <div id="id2" style="height: 131px; left: 405px; position: absolute; top: 1271px; width: 150px; z-index: 1; " class="style_SkipStroke_1 shape-with-text stroke_0 shadow_0">
            <div class="text-content graphic_textbox_layout_style_default_External_148_129" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style">Readout Thread</p>
              </div>
            </div>
          </div>
          


          <div id="id3" style="height: 131px; left: 246px; position: absolute; top: 1271px; width: 150px; z-index: 1; " class="style_SkipStroke_1 shape-with-text stroke_1 shadow_1">
            <div class="text-content graphic_textbox_layout_style_default_External_148_129" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style">Transfer Thread</p>
              </div>
            </div>
          </div>
          


          <div style="height: 124px; width: 162px;  height: 123px; left: 93px; position: absolute; top: 362px; width: 161px; z-index: 1; " class="tinyText shadow_2">
            <div style="position: relative; width: 161px; ">
              <img src="Embedded_Computers_files/shapeimage_2.png" alt="" style="height: 124px; left: 0px; position: absolute; top: 0px; width: 162px; " />
            </div>
          </div>
          


          <div id="id4" style="height: 145px; left: 7px; position: absolute; top: 19px; width: 683px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_683_145" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="paragraph_style_1"><span style="line-height: 19px; " class="style_1">ORCA uses crate-level embedded single board computers (SBC) as a direct extension of itself. Download code and makefiles are managed as part of ORCA’s code base and are transferred to the SBC and compiled in a semi-automatic fashion.<br /></span></p>
                <p class="paragraph_style_1"><span style="line-height: 19px; " class="style_1"><br /></span></p>
                <p style="padding-bottom: 0pt; " class="paragraph_style_1"><span style="line-height: 19px; " class="style_1">The code that is downloaded to the SBC is composed of a small set of routines that handle the communication socket, the data transfer circular buffer, and other common functions. Specific code for a given SBC is combined with the base code as needed for different types of hardware, i.e. VME, cPCI, etc.</span></p>
              </div>
            </div>
          </div>
          


          <div style="height: 128px; width: 128px;  height: 128px; left: 95px; position: absolute; top: 183px; width: 128px; z-index: 1; " class="tinyText style_SkipStroke_3 stroke_2 shadow_3">
            <img src="Embedded_Computers_files/Orca.png" alt="" style="border: none; height: 128px; width: 128px; " />
          </div>
          


          <div id="id5" style="height: 60px; left: 104px; position: absolute; top: 372px; width: 137px; z-index: 1; " class="style_SkipStroke_4 shape-with-text stroke_3">
            <div class="text-content graphic_textbox_layout_style_default_External_135_58" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style">Core code for socket handling, data transfer, common functionality.</p>
              </div>
            </div>
          </div>
          


          <div style="height: 72px; width: 71px;  height: 72px; left: 84px; position: absolute; top: 461px; width: 70px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 70px; ">
              <img src="Embedded_Computers_files/shapeimage_3.png" alt="" style="height: 72px; left: 0px; margin-left: -1px; position: absolute; top: 0px; width: 71px; " />
            </div>
          </div>
          


          <div id="id6" style="height: 110px; left: 22px; position: absolute; top: 524px; width: 89px; z-index: 1; " class="style_SkipStroke_1 shape-with-text stroke_4 shadow_4">
            <div class="text-content graphic_textbox_layout_style_default_External_87_108" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="paragraph_style_2">VME<br /></p>
                <p style="padding-bottom: 0pt; " class="paragraph_style">HW specific makefile, code for event readout, and HW access.</p>
              </div>
            </div>
          </div>
          


          <div style="height: 89px; width: 7px;  height: 89px; left: 165px; position: absolute; top: 458px; width: 1px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 1px; ">
              <img src="Embedded_Computers_files/shapeimage_4.png" alt="" style="height: 89px; left: 0px; margin-left: -3px; position: absolute; top: 0px; width: 7px; " />
            </div>
          </div>
          


          <div id="id7" style="height: 110px; left: 125px; position: absolute; top: 524px; width: 88px; z-index: 1; " class="style_SkipStroke_5 shape-with-text stroke_5 shadow_5">
            <div class="text-content graphic_textbox_layout_style_default_External_86_108" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="paragraph_style"><span class="style_2">cPCI <br /></span></p>
                <p style="padding-bottom: 0pt; " class="paragraph_style">HW specific makefile, code for event readout, and HW access.</p>
              </div>
            </div>
          </div>
          


          <div style="height: 77px; width: 77px;  height: 77px; left: 180px; position: absolute; top: 462px; width: 76px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 76px; ">
              <img src="Embedded_Computers_files/shapeimage_5.png" alt="" style="height: 77px; left: 0px; position: absolute; top: 0px; width: 77px; " />
            </div>
          </div>
          


          <div id="id8" style="height: 26px; left: 104px; position: absolute; top: 442px; width: 137px; z-index: 1; " class="style_SkipStroke_4 shape-with-text stroke_6">
            <div class="text-content graphic_textbox_layout_style_default_External_135_24" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style">Code for specific HW </p>
              </div>
            </div>
          </div>
          


          <div id="id9" style="height: 110px; left: 231px; position: absolute; top: 524px; width: 90px; z-index: 1; " class="style_SkipStroke_6 shape-with-text stroke_7 shadow_6">
            <div class="text-content graphic_textbox_layout_style_default_External_88_108" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="paragraph_style"><span class="style_2">IPE <br /></span></p>
                <p style="padding-bottom: 0pt; " class="paragraph_style">HW specific makefile, code for event readout, and HW access.</p>
              </div>
            </div>
          </div>
          


          <div style="height: 10px; width: 285px;  height: 1px; left: 223px; position: absolute; top: 242px; width: 285px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 285px; ">
              <img src="Embedded_Computers_files/shapeimage_6.png" alt="" style="height: 10px; left: 0px; margin-top: -5px; position: absolute; top: 0px; width: 285px; " />
            </div>
          </div>
          


          <div style="height: 53px; width: 10px;  height: 53px; left: 169px; position: absolute; top: 298px; width: 1px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 1px; ">
              <img src="Embedded_Computers_files/shapeimage_7.png" alt="" style="height: 53px; left: 0px; margin-left: -5px; position: absolute; top: 0px; width: 10px; " />
            </div>
          </div>
          


          <div id="id10" style="height: 88px; left: 241px; position: absolute; top: 251px; width: 225px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_225_88" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="Body">Orca assembles the custom code package for a specific SBC, downloads, compiles, starts, and initiates a connection</p>
              </div>
            </div>
          </div>
          


          <div id="id11" style="height: 68px; left: 353px; position: absolute; top: 527px; width: 315px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_315_68" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="Body">Since each code set has its own makefile, the package can be linked to specific HW drivers and/or libraries</p>
              </div>
            </div>
          </div>
          


          <div id="id12" style="height: 24px; left: 494px; position: absolute; top: 313px; width: 112px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_112_24" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_3">SBC running Linux</p>
              </div>
            </div>
          </div>
          


          <div id="id13" style="height: 27px; left: 284px; position: absolute; top: 219px; width: 134px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_134_27" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_2">Internet connection</p>
              </div>
            </div>
          </div>
          


          <div id="id14" style="height: 249px; left: 17px; position: absolute; top: 1697px; width: 607px; z-index: 1; " class="style_SkipStroke_7 shape-with-text stroke_8 shadow_7">
            <div class="text-content graphic_textbox_layout_style_default_External_605_247" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="paragraph_style_4"><span class="style_3">typedef</span><span class="style_4"> </span><span class="style_3">struct</span><span class="style_4"> {<br /></span></p>
                <p class="paragraph_style_4"><span class="style_4">    uint32_t header;<br /></span></p>
                <p class="paragraph_style_4"><span class="style_4">    uint32_t total_cards;                     </span><span class="style_5">// total sum of all cards</span><span class="style_4"><br /></span></p>
                <p class="paragraph_style_4"><span class="style_4">    </span><span class="style_3">struct</span><span class="style_4"> {    </span><span class="style_5">// structure required for card</span><span class="style_4"><br /></span></p>
                <p class="paragraph_style_4"><span class="style_4">        uint32_t hw_type_id;                  </span><span class="style_5">// unique hardware identifier code</span><span class="style_4"><br /></span></p>
                <p class="paragraph_style_4"><span class="style_4">        uint32_t hw_mask[</span><span class="style_6">10</span><span class="style_4">];          </span><span class="style_5">// hardware identifier mask to OR into data word</span><span class="style_4"><br /></span></p>
                <p class="paragraph_style_4"><span class="style_4">        uint32_t slot;    </span><span class="style_5">// slot identifier</span><span class="style_4"><br /></span></p>
                <p class="paragraph_style_4"><span class="style_4">        uint32_t crate;    </span><span class="style_5">// crate identifier</span><span class="style_4"><br /></span></p>
                <p class="paragraph_style_4"><span class="style_4">        uint32_t base_add;    </span><span class="style_5">// base addresses for each card</span><span class="style_4"><br /></span></p>
                <p class="paragraph_style_4"><span class="style_4">        uint32_t add_mod;    </span><span class="style_5">// address modifier (if needed)</span><span class="style_4"><br /></span></p>
                <p class="paragraph_style_4"><span class="style_4">        uint32_t deviceSpecificData[</span><span class="style_6">256</span><span class="style_4">];    </span><span class="style_5">// a card can use this block as needed.</span><span class="style_4"><br /></span></p>
                <p class="paragraph_style_4"><span class="style_4">        uint32_t next_Card_Index;    </span><span class="style_5">// next card_info index to be read after this one.        </span><span class="style_4"><br /></span></p>
                <p class="paragraph_style_4"><span class="style_4">        uint32_t num_Trigger_Indexes;    </span><span class="style_5">// number of triggers for this card</span><span class="style_4"><br /></span></p>
                <p class="paragraph_style_4"><span class="style_4">        uint32_t next_Trigger_Index[</span><span class="style_6">3</span><span class="style_4">];    </span><span class="style_5">//card_info index for device specific trigger</span><span class="style_4"><br /></span></p>
                <p class="paragraph_style_4"><span class="style_4">    } card_info[MAX_CARDS];<br /></span></p>
                <p class="paragraph_style_4"><span class="style_4">} SBC_crate_config;<br /></span></p>
              </div>
            </div>
          </div>
          


          <div id="id15" style="height: 17px; left: 293px; position: absolute; top: 1296px; width: 242px; z-index: 1; " class="style_SkipStroke_8 shape-with-text stroke_9 shadow_8">
            <div class="text-content graphic_shape_layout_style_default_External_240_15" style="padding: 1px; ">
              <div class="graphic_shape_layout_style_default"></div>
            </div>
          </div>
          


          <div id="id16" style="height: 17px; left: 376px; position: absolute; top: 1296px; width: 15px; z-index: 1; " class="style_SkipStroke_9 shape-with-text stroke_9">
            <div class="text-content graphic_shape_layout_style_default_External_13_15" style="padding: 1px; ">
              <div class="graphic_shape_layout_style_default"></div>
            </div>
          </div>
          


          <div style="height: 104px; width: 10px;  height: 104px; left: 463px; position: absolute; top: 1316px; width: 1px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 1px; ">
              <img src="Embedded_Computers_files/shapeimage_8.png" alt="" style="height: 104px; left: 0px; margin-left: -5px; position: absolute; top: 0px; width: 10px; " />
            </div>
          </div>
          


          <div style="height: 10px; width: 217px;  height: 1px; left: 160px; position: absolute; top: 1329px; width: 217px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 217px; ">
              <img src="Embedded_Computers_files/shapeimage_9.png" alt="" style="height: 10px; left: 0px; margin-top: -5px; position: absolute; top: 0px; width: 217px; " />
            </div>
          </div>
          


          <div style="height: 10px; width: 2px;  height: 10px; left: 376px; position: absolute; top: 1318px; width: 1px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 1px; ">
              <img src="Embedded_Computers_files/shapeimage_10.jpg" alt="" style="height: 10px; left: 0px; margin-left: -1px; position: absolute; top: 0px; width: 2px; " />
            </div>
          </div>
          


          <div id="id17" style="height: 17px; left: 390px; position: absolute; top: 1296px; width: 15px; z-index: 1; " class="style_SkipStroke_9 shape-with-text stroke_9">
            <div class="text-content graphic_shape_layout_style_default_External_13_15" style="padding: 1px; ">
              <div class="graphic_shape_layout_style_default"></div>
            </div>
          </div>
          


          <div id="id18" style="height: 17px; left: 405px; position: absolute; top: 1296px; width: 15px; z-index: 1; " class="style_SkipStroke_9 shape-with-text stroke_9">
            <div class="text-content graphic_shape_layout_style_default_External_13_15" style="padding: 1px; ">
              <div class="graphic_shape_layout_style_default"></div>
            </div>
          </div>
          


          <div id="id19" style="height: 17px; left: 420px; position: absolute; top: 1296px; width: 15px; z-index: 1; " class="style_SkipStroke_9 shape-with-text stroke_9">
            <div class="text-content graphic_shape_layout_style_default_External_13_15" style="padding: 1px; ">
              <div class="graphic_shape_layout_style_default"></div>
            </div>
          </div>
          


          <div id="id20" style="height: 17px; left: 434px; position: absolute; top: 1296px; width: 15px; z-index: 1; " class="style_SkipStroke_9 shape-with-text stroke_9">
            <div class="text-content graphic_shape_layout_style_default_External_13_15" style="padding: 1px; ">
              <div class="graphic_shape_layout_style_default"></div>
            </div>
          </div>
          


          <div id="id21" style="height: 17px; left: 449px; position: absolute; top: 1296px; width: 15px; z-index: 1; " class="style_SkipStroke_9 shape-with-text stroke_9">
            <div class="text-content graphic_shape_layout_style_default_External_13_15" style="padding: 1px; ">
              <div class="graphic_shape_layout_style_default"></div>
            </div>
          </div>
          


          <div id="id22" style="height: 17px; left: 271px; position: absolute; top: 1336px; width: 15px; z-index: 1; " class="style_SkipStroke_10 shape-with-text stroke_9 shadow_9">
            <div class="text-content graphic_shape_layout_style_default_External_13_15" style="padding: 1px; ">
              <div class="graphic_shape_layout_style_default"></div>
            </div>
          </div>
          


          <div id="id23" style="height: 17px; left: 300px; position: absolute; top: 1336px; width: 15px; z-index: 1; " class="style_SkipStroke_10 shape-with-text stroke_9 shadow_10">
            <div class="text-content graphic_shape_layout_style_default_External_13_15" style="padding: 1px; ">
              <div class="graphic_shape_layout_style_default"></div>
            </div>
          </div>
          


          <div id="id24" style="height: 17px; left: 325px; position: absolute; top: 1336px; width: 15px; z-index: 1; " class="style_SkipStroke_10 shape-with-text stroke_9 shadow_11">
            <div class="text-content graphic_shape_layout_style_default_External_13_15" style="padding: 1px; ">
              <div class="graphic_shape_layout_style_default"></div>
            </div>
          </div>
          


          <div style="height: 128px; width: 128px;  height: 128px; left: 26px; position: absolute; top: 1259px; width: 128px; z-index: 1; " class="tinyText style_SkipStroke_3 stroke_2 shadow_12">
            <img src="Embedded_Computers_files/Orca_1.png" alt="" style="border: none; height: 128px; width: 128px; " />
          </div>
          


          <div id="id25" style="height: 24px; left: 291px; position: absolute; top: 1293px; width: 98px; z-index: 1; " class="style_SkipStroke_11 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_98_24" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_5">Circular Buffer</p>
              </div>
            </div>
          </div>
          


          <div id="id26" style="height: 17px; left: 435px; position: absolute; top: 1327px; width: 15px; z-index: 1; " class="style_SkipStroke_10 shape-with-text stroke_9 shadow_13">
            <div class="text-content graphic_shape_layout_style_default_External_13_15" style="padding: 1px; ">
              <div class="graphic_shape_layout_style_default"></div>
            </div>
          </div>
          


          <div id="id27" style="height: 17px; left: 435px; position: absolute; top: 1351px; width: 15px; z-index: 1; " class="style_SkipStroke_10 shape-with-text stroke_9 shadow_14">
            <div class="text-content graphic_shape_layout_style_default_External_13_15" style="padding: 1px; ">
              <div class="graphic_shape_layout_style_default"></div>
            </div>
          </div>
          


          <div id="id28" style="height: 17px; left: 435px; position: absolute; top: 1376px; width: 15px; z-index: 1; " class="style_SkipStroke_10 shape-with-text stroke_9 shadow_15">
            <div class="text-content graphic_shape_layout_style_default_External_13_15" style="padding: 1px; ">
              <div class="graphic_shape_layout_style_default"></div>
            </div>
          </div>
          


          <div id="id29" style="height: 41px; left: 159px; position: absolute; top: 1340px; width: 73px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_73_41" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="paragraph_style_6">Internet <br /></p>
                <p style="padding-bottom: 0pt; " class="paragraph_style_6">connection</p>
              </div>
            </div>
          </div>
          


          <div style="height: 128px; width: 74px;  height: 128px; left: 513px; position: absolute; top: 183px; width: 74px; z-index: 1; " class="tinyText style_SkipStroke_3 stroke_2 shadow_16">
            <img src="Embedded_Computers_files/Picture%202.jpg" alt="" style="border: none; height: 128px; width: 74px; " />
          </div>
          


          <div style="height: 128px; width: 74px;  height: 128px; left: 455px; position: absolute; top: 1423px; width: 74px; z-index: 1; " class="tinyText style_SkipStroke_3 stroke_2 shadow_17">
            <img src="Embedded_Computers_files/Picture%202_1.jpg" alt="" style="border: none; height: 128px; width: 74px; " />
          </div>
          


          <div id="id30" style="height: 24px; left: 267px; position: absolute; top: 1356px; width: 85px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_85_24" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_5">Data Records</p>
              </div>
            </div>
          </div>
          


          <div style="height: 10px; width: 76px;  height: 1px; left: 165px; position: absolute; top: 1313px; width: 76px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 76px; ">
              <img src="Embedded_Computers_files/shapeimage_11.png" alt="" style="height: 10px; left: 0px; margin-top: -5px; position: absolute; top: 0px; width: 76px; " />
            </div>
          </div>
          


          <div style="height: 36px; width: 11px;  height: 34px; left: 191px; position: absolute; top: 1305px; width: 9px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 9px; ">
              <img src="Embedded_Computers_files/shapeimage_12.png" alt="" style="height: 36px; left: 0px; margin-left: -1px; margin-top: -1px; position: absolute; top: 0px; width: 11px; " />
            </div>
          </div>
          


          <div id="id31" style="height: 36px; left: 475px; position: absolute; top: 1333px; width: 55px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_55_36" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="paragraph_style_7">Readout<br /></p>
                <p style="padding-bottom: 0pt; " class="paragraph_style_7">Loop</p>
              </div>
            </div>
          </div>
          


          <div style="height: 10px; width: 62px;  height: 1px; left: 473px; position: absolute; top: 1329px; width: 62px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 62px; ">
              <img src="Embedded_Computers_files/shapeimage_13.png" alt="" style="height: 10px; left: 0px; margin-top: -5px; position: absolute; top: 0px; width: 62px; " />
            </div>
          </div>
          


          <div style="height: 10px; width: 62px;  height: 1px; left: 473px; position: absolute; top: 1376px; width: 62px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 62px; ">
              <img src="Embedded_Computers_files/shapeimage_14.png" alt="" style="height: 10px; left: 0px; margin-top: -5px; position: absolute; top: 0px; width: 62px; " />
            </div>
          </div>
          


          <div style="height: 36px; width: 10px;  height: 36px; left: 473px; position: absolute; top: 1333px; width: 1px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 1px; ">
              <img src="Embedded_Computers_files/shapeimage_15.png" alt="" style="height: 36px; left: 0px; margin-left: -5px; position: absolute; top: 0px; width: 10px; " />
            </div>
          </div>
          


          <div style="height: 36px; width: 10px;  height: 36px; left: 533px; position: absolute; top: 1447px; width: 1px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 1px; ">
              <img src="Embedded_Computers_files/shapeimage_16.png" alt="" style="height: 36px; left: 0px; margin-left: -5px; position: absolute; top: 0px; width: 10px; " />
            </div>
          </div>
          


          <div style="height: 39px; width: 10px;  height: 39px; left: 476px; position: absolute; top: 1381px; width: 1px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 1px; ">
              <img src="Embedded_Computers_files/shapeimage_17.png" alt="" style="height: 39px; left: 0px; margin-left: -5px; position: absolute; top: 0px; width: 10px; " />
            </div>
          </div>
          


          <div id="id32" style="height: 50px; left: -4px; position: absolute; top: 1182px; width: 683px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_683_50" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default"></div>
            </div>
          </div>
          


          <div style="height: 57px; width: 300px;  height: 57px; left: 380px; position: absolute; top: 714px; width: 300px; z-index: 1; " class="tinyText style_SkipStroke_3 stroke_2 shadow_18">
            <img src="Embedded_Computers_files/Picture%2012.jpg" alt="" style="border: none; height: 58px; width: 300px; " />
          </div>
          


          <div id="id33" style="height: 317px; left: 3px; position: absolute; top: 686px; width: 360px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_360_317" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Body"><span style="line-height: 25px; " class="style_7">Starting the Crate</span><br /></p>
                <p class="Body"><br /></p>
                <p class="Body">When a SBC <span class="style_8">Start Crate</span> is initiated from an SBC control dialog, ORCA does the following actions.<br /></p>
                <p class="Body"><br /></p>
                <p class="Body">If the <span class="style_8">Force Reload</span> option is selected:<br /></p>
                <ol>
                  <li style="line-height: 20px; padding-left: 0px; text-indent: 0px; " class="full-width" value="1">
                    <p style="text-indent: 0px; " class="paragraph_style_8"><span style="font-size: 15px; " class="Bullet">1.</span> All code in the ORCA folder in the SBC is deleted.<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 0px; text-indent: 0px; " class="full-width" value="2">
                    <p style="text-indent: 0px; " class="paragraph_style_8"><span style="font-size: 15px; " class="Bullet">2.</span> The startup scripts are modified as necessary.<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 0px; text-indent: 0px; " class="full-width" value="3">
                    <p style="text-indent: 0px; " class="paragraph_style_8"><span style="font-size: 15px; " class="Bullet">3.</span> The core code is downloaded.<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 0px; text-indent: 0px; " class="full-width" value="4">
                    <p style="text-indent: 0px; " class="paragraph_style_8"><span style="font-size: 15px; " class="Bullet">4.</span> The HW specific code is downloaded.<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 0px; text-indent: 0px; " class="full-width" value="5">
                    <p style="text-indent: 0px; " class="paragraph_style_8"><span style="font-size: 15px; " class="Bullet">5.</span> A organization script is run to make a flat ORCA folder on the SBC.<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 0px; text-indent: 0px; " class="full-width" value="6">
                    <p style="text-indent: 0px; " class="paragraph_style_8"><span style="font-size: 15px; " class="Bullet">6.</span> A compile script is run on the SBC.<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 0px; text-indent: 0px; " class="full-width" value="7">
                    <p style="text-indent: 0px; " class="paragraph_style_8"><span style="font-size: 15px; " class="Bullet">7.</span> The code is started. <br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 0px; text-indent: 0px; " class="full-width" value="8">
                    <p style="padding-bottom: 0pt; text-indent: 0px; " class="paragraph_style_8"><span style="font-size: 15px; " class="Bullet">8.</span> The socket is opened.</p>
                  </li>
                </ol>
              </div>
            </div>
          </div>
          


          <div id="id34" style="height: 24px; left: 381px; position: absolute; top: 690px; width: 187px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_187_24" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_2">Part of the SBC control dialog</p>
              </div>
            </div>
          </div>
          


          <div id="id35" style="height: 236px; left: 1px; position: absolute; top: 1008px; width: 695px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_695_236" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Body">If the <span class="style_8">Force Reload</span> option is <span class="style_2">not</span> selected:<br /></p>
                <ol>
                  <li style="line-height: 20px; padding-left: 0px; text-indent: 0px; " class="full-width" value="1">
                    <p style="text-indent: 0px; " class="paragraph_style_8"><span style="font-size: 15px; " class="Bullet">1.</span> A connection is attempted.<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 17px; text-indent: -17px; " class="full-width" value="2">
                    <p style="text-indent: -17px; " class="paragraph_style_9"><span style="font-size: 15px; " class="Bullet">2.</span><span style="width: 4px; " class="inline-block"></span>If the connection is successful, then we’re done.<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 17px; text-indent: -17px; " class="full-width" value="3">
                    <p style="text-indent: -17px; " class="paragraph_style_9"><span style="font-size: 15px; " class="Bullet">3.</span><span style="width: 4px; " class="inline-block"></span>If a connection can not be made, then an attempt is made to start the code.<br /></p>
                  </li>
                  <li style="line-height: 20px; padding-left: 17px; text-indent: -17px; " class="full-width" value="4">
                    <p style="text-indent: -17px; " class="paragraph_style_9"><span style="font-size: 15px; " class="Bullet">4.</span><span style="width: 4px; " class="inline-block"></span>If a connection can still not be made, then a complete reload of the code is done as if the Force Reload option had been selected.<br /></p>
                  </li>
                </ol>
                <p class="paragraph_style_10"><br /></p>
                <p class="Body"><span style="line-height: 25px; " class="style_7">Code Organization<br /></span></p>
                <p class="Body"><br /></p>
                <p style="padding-bottom: 0pt; " class="Body">The SBC code takes data using two threads, a readout thread and a data transfer thread. The data transfer thread also handles all communication to/from ORCA</p>
              </div>
            </div>
          </div>
          


          <div id="id36" style="height: 113px; left: 3px; position: absolute; top: 1569px; width: 669px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_669_113" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Body"><span style="line-height: 25px; " class="style_7">Data Structures<br /></span></p>
                <p class="Body"><br /></p>
                <p class="Body">The SBC_crate_config data structure is used to pass the hardware readout list to the SBC. It contains all information needed for the SBC to set up data records, determine base addresses, etc.<br /></p>
                <p style="padding-bottom: 0pt; " class="Body">The actual definition looks like this:</p>
              </div>
            </div>
          </div>
          


          <div id="id37" style="height: 313px; left: 3px; position: absolute; top: 1974px; width: 374px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_374_313" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Body">If the readout list is flat then the structure is also flat and the fields, <span class="style_8">num_Trigger_Indexes </span>will be set to zero. If, however, a piece of hardware is a trigger card that controls the readout based on some trigger information then the <span class="style_8">num_Trigger_Indexes </span>will be non-zero and the <span class="style_8">next_Trigger_Index[0] </span>will indicate the offset to the next to card to be read in the case of a trigger. <br /></p>
                <p class="Body"><br /></p>
                <p class="Body">The configuration structure is set up automatically based on the readout list in the ORCA <a title="../Data_Chain/Data_Read_out.html" href="../Data_Chain/Data_Read_out.html">Data Taker</a>. The only data that each object needs to fill in are the dataIDs, slot, crate, base address, and any device specific information.<br /></p>
              </div>
            </div>
          </div>
          


          <div style="height: 128px; width: 245px;  height: 128px; left: 399px; position: absolute; top: 2133px; width: 245px; z-index: 1; " class="tinyText style_SkipStroke_3 stroke_2 shadow_19">
            <img src="Embedded_Computers_files/Picture%2013.jpg" alt="" style="border: none; height: 128px; width: 245px; " />
          </div>
          


          <div style="height: 95px; width: 248px;  height: 95px; left: 398px; position: absolute; top: 1976px; width: 248px; z-index: 1; " class="tinyText style_SkipStroke_3 stroke_2 shadow_20">
            <img src="Embedded_Computers_files/Picture%2014.jpg" alt="" style="border: none; height: 95px; width: 248px; " />
          </div>
          


          <div id="id38" style="height: 24px; left: 403px; position: absolute; top: 1955px; width: 202px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_202_24" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_6">Flat Readout</p>
              </div>
            </div>
          </div>
          


          <div id="id39" style="height: 24px; left: 410px; position: absolute; top: 2108px; width: 202px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_202_24" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_6">Triggered Readout</p>
              </div>
            </div>
          </div>
          


          <div style="height: 34px; width: 10px;  height: 34px; left: 533px; position: absolute; top: 1334px; width: 1px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 1px; ">
              <img src="Embedded_Computers_files/shapeimage_18.png" alt="" style="height: 34px; left: 0px; margin-left: -5px; position: absolute; top: 0px; width: 10px; " />
            </div>
          </div>
          


          <div id="id40" style="height: 93px; left: 5px; position: absolute; top: 2283px; width: 669px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_669_93" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Body"><span style="line-height: 25px; " class="style_7">Hardware Specific Readout<br /></span></p>
                <p class="Body"><br /></p>
                <p style="padding-bottom: 0pt; " class="Body">In the HW_Readout.c file of the hardware specific part of the SBC code the readout of the hardware is controlled by the <span class="style_8">readHW</span> routine:</p>
              </div>
            </div>
          </div>
          


          <div id="id41" style="height: 263px; left: 4px; position: absolute; top: 2458px; width: 607px; z-index: 1; " class="style_SkipStroke_7 shape-with-text stroke_10 shadow_21">
            <div class="text-content graphic_textbox_layout_style_default_External_605_261" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">int32_t readHW(SBC_crate_config* config,int32_t index, SBC_LAM_Data* lamData)<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">{<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">    </span><span style="line-height: 14px; " class="style_10">if</span><span style="line-height: 14px; " class="style_9">(index&lt;config-&gt;total_cards &amp;&amp; index&gt;=</span><span style="line-height: 14px; " class="style_11">0</span><span style="line-height: 14px; " class="style_9">) {<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">        </span><span style="line-height: 14px; " class="style_10">switch</span><span style="line-height: 14px; " class="style_9">(config-&gt;card_info[index].hw_type_id){<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">            </span><span style="line-height: 14px; " class="style_10">case</span><span style="line-height: 14px; " class="style_9"> kShaper:       index = Readout_Shaper(config,index,lamData);       </span><span style="line-height: 14px; " class="style_10">break</span><span style="line-height: 14px; " class="style_9">;<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">            </span><span style="line-height: 14px; " class="style_10">case</span><span style="line-height: 14px; " class="style_9"> kGretina:      index = Readout_Gretina(config,index,lamData);      </span><span style="line-height: 14px; " class="style_10">break</span><span style="line-height: 14px; " class="style_9">;<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">            </span><span style="line-height: 14px; " class="style_10">case</span><span style="line-height: 14px; " class="style_9"> kTrigger32:    index = Readout_TR32_Data(config,index,lamData);    </span><span style="line-height: 14px; " class="style_10">break</span><span style="line-height: 14px; " class="style_9">;<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">            </span><span style="line-height: 14px; " class="style_10">case</span><span style="line-height: 14px; " class="style_9"> kCaen:         index = Readout_CAEN(config,index,lamData);         </span><span style="line-height: 14px; " class="style_10">break</span><span style="line-height: 14px; " class="style_9">;<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">               ...<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">               ...<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">               ...<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">            </span><span style="line-height: 14px; " class="style_10">default</span><span style="line-height: 14px; " class="style_9">:            index = -</span><span style="line-height: 14px; " class="style_11">1</span><span style="line-height: 14px; " class="style_9">;                                         </span><span style="line-height: 14px; " class="style_10">break</span><span style="line-height: 14px; " class="style_9">;<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">        }<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">        </span><span style="line-height: 14px; " class="style_10">return</span><span style="line-height: 14px; " class="style_9"> index;<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">    }<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">    </span><span style="line-height: 14px; " class="style_10">else</span><span style="line-height: 14px; " class="style_9"> </span><span style="line-height: 14px; " class="style_10">return</span><span style="line-height: 14px; " class="style_9"> -</span><span style="line-height: 14px; " class="style_11">1</span><span style="line-height: 14px; " class="style_9">;<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">}<br /></span></p>
              </div>
            </div>
          </div>
          


          <div style="height: 103px; width: 54px;  height: 103px; left: 132px; position: absolute; top: 2418px; width: 52px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 52px; ">
              <img src="Embedded_Computers_files/shapeimage_19.png" alt="" style="height: 103px; left: 0px; margin-left: -1px; position: absolute; top: 0px; width: 54px; " />
            </div>
          </div>
          


          <div id="id42" style="height: 60px; left: 71px; position: absolute; top: 2389px; width: 173px; z-index: 1; " class="style_SkipStroke_4 shape-with-text stroke_11">
            <div class="text-content graphic_textbox_layout_style_default_External_171_58" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_12">Each object to be read out must have a unique id, which is set in <span class="style_8">xxx_HW_Definitions.h</span></p>
              </div>
            </div>
          </div>
          


          <div style="height: 13px; width: 87px;  height: 11px; left: 77px; position: absolute; top: 2520px; width: 85px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 85px; ">
              <img src="Embedded_Computers_files/shapeimage_20.png" alt="" style="height: 13px; left: 0px; margin-left: -1px; margin-top: -1px; position: absolute; top: 0px; width: 87px; " />
            </div>
          </div>
          


          <div style="height: 92px; width: 10px;  height: 92px; left: 350px; position: absolute; top: 2427px; width: 8px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 8px; ">
              <img src="Embedded_Computers_files/shapeimage_21.png" alt="" style="height: 92px; left: 0px; margin-left: -1px; position: absolute; top: 0px; width: 10px; " />
            </div>
          </div>
          


          <div id="id43" style="height: 43px; left: 278px; position: absolute; top: 2405px; width: 151px; z-index: 1; " class="style_SkipStroke_4 shape-with-text stroke_12">
            <div class="text-content graphic_textbox_layout_style_default_External_149_41" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_12">Each object must define a readout routine</p>
              </div>
            </div>
          </div>
          


          <div style="height: 15px; width: 230px;  height: 13px; left: 247px; position: absolute; top: 2519px; width: 228px; z-index: 1; " class="tinyText">
            <div style="position: relative; width: 228px; ">
              <img src="Embedded_Computers_files/shapeimage_22.png" alt="" style="height: 15px; left: 0px; margin-left: -1px; margin-top: -1px; position: absolute; top: 0px; width: 230px; " />
            </div>
          </div>
          


          <div id="id44" style="height: 641px; left: 11px; position: absolute; top: 2824px; width: 683px; z-index: 1; " class="style_SkipStroke_7 shape-with-text stroke_13 shadow_22">
            <div class="text-content graphic_textbox_layout_style_default_External_681_639" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">int32_t Readout_Shaper(SBC_crate_config* config,int32_t index, SBC_LAM_Data* lamData)<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">{<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">    uint32_t baseAddress            = config-&gt;card_info[index].base_add;<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">    uint32_t conversionRegOffset    = config-&gt;card_info[index].deviceSpecificData[</span><span style="line-height: 14px; " class="style_11">1</span><span style="line-height: 14px; " class="style_9">];<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">    <br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">    </span><span style="line-height: 14px; " class="style_10">char</span><span style="line-height: 14px; " class="style_9"> theConversionMask;<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">    int32_t result    = read_device(vmeAM29Handle,&amp;theConversionMask,</span><span style="line-height: 14px; " class="style_11">1</span><span style="line-height: 14px; " class="style_9">,baseAddress+conversionRegOffset); <br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">    </span><span style="line-height: 14px; " class="style_10">if</span><span style="line-height: 14px; " class="style_9">(result == </span><span style="line-height: 14px; " class="style_11">1</span><span style="line-height: 14px; " class="style_9"> &amp;&amp; theConversionMask != </span><span style="line-height: 14px; " class="style_11">0</span><span style="line-height: 14px; " class="style_9">){<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9"><br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">        uint32_t dataId            = config-&gt;card_info[index].hw_mask[</span><span style="line-height: 14px; " class="style_11">0</span><span style="line-height: 14px; " class="style_9">];<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">        uint32_t slot              = config-&gt;card_info[index].slot;<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">        uint32_t crate             = config-&gt;card_info[index].crate;<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">        uint32_t locationMask      = ((crate &amp; </span><span style="line-height: 14px; " class="style_11">0x01e</span><span style="line-height: 14px; " class="style_9">)&lt;&lt;</span><span style="line-height: 14px; " class="style_11">21</span><span style="line-height: 14px; " class="style_9">) | ((slot &amp; </span><span style="line-height: 14px; " class="style_11">0x0000001f</span><span style="line-height: 14px; " class="style_9">)&lt;&lt;</span><span style="line-height: 14px; " class="style_11">16</span><span style="line-height: 14px; " class="style_9">);<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">        uint32_t onlineMask        = config-&gt;card_info[index].deviceSpecificData[</span><span style="line-height: 14px; " class="style_11">0</span><span style="line-height: 14px; " class="style_9">];<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">        uint32_t firstAdcRegOffset = config-&gt;card_info[index].deviceSpecificData[</span><span style="line-height: 14px; " class="style_11">2</span><span style="line-height: 14px; " class="style_9">];<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9"><br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">        int16_t channel;<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">        </span><span style="line-height: 14px; " class="style_10">for</span><span style="line-height: 14px; " class="style_9"> (channel=</span><span style="line-height: 14px; " class="style_11">0</span><span style="line-height: 14px; " class="style_9">; channel&lt;</span><span style="line-height: 14px; " class="style_11">8</span><span style="line-height: 14px; " class="style_9">; ++channel) {<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">            </span><span style="line-height: 14px; " class="style_10">if</span><span style="line-height: 14px; " class="style_9">(onlineMask &amp; theConversionMask &amp; (</span><span style="line-height: 14px; " class="style_11">1L</span><span style="line-height: 14px; " class="style_9">&lt;&lt;channel)){<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">                uint16_t aValue;<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">                result    = read_device(vmeAM29Handle,(</span><span style="line-height: 14px; " class="style_10">char</span><span style="line-height: 14px; " class="style_9">*)&amp;aValue,<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_11">                                        2</span><span style="line-height: 14px; " class="style_9">,baseAddress+firstAdcRegOffset+</span><span style="line-height: 14px; " class="style_11">2</span><span style="line-height: 14px; " class="style_9">*channel); </span><span style="line-height: 14px; " class="style_12"><br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">                </span><span style="line-height: 14px; " class="style_10">if</span><span style="line-height: 14px; " class="style_9">(result == </span><span style="line-height: 14px; " class="style_11">2</span><span style="line-height: 14px; " class="style_9">){<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">                    </span><span style="line-height: 14px; " class="style_10">if</span><span style="line-height: 14px; " class="style_9">(((dataId) &amp; </span><span style="line-height: 14px; " class="style_11">0x80000000</span><span style="line-height: 14px; " class="style_9">)){ </span><span style="line-height: 14px; " class="style_12">//short form</span><span style="line-height: 14px; " class="style_9"><br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">                        data[dataIndex++] = dataId       | <br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">                                            locationMask | <br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">                                            ((channel &amp; </span><span style="line-height: 14px; " class="style_11">0x0000000f</span><span style="line-height: 14px; " class="style_9">) &lt;&lt; </span><span style="line-height: 14px; " class="style_11">12</span><span style="line-height: 14px; " class="style_9">) | <br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">                                            (aValue &amp; </span><span style="line-height: 14px; " class="style_11">0x0fff</span><span style="line-height: 14px; " class="style_9">);<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">                    }<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">                    </span><span style="line-height: 14px; " class="style_10">else</span><span style="line-height: 14px; " class="style_9"> { </span><span style="line-height: 14px; " class="style_12">//long form</span><span style="line-height: 14px; " class="style_9"><br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">                        data[dataIndex++] = dataId | </span><span style="line-height: 14px; " class="style_11">2</span><span style="line-height: 14px; " class="style_9">;<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">                        data[dataIndex++] = locationMask | ((channel &amp; </span><span style="line-height: 14px; " class="style_11">0x0000000f</span><span style="line-height: 14px; " class="style_9">) &lt;&lt; </span><span style="line-height: 14px; " class="style_11">12</span><span style="line-height: 14px; " class="style_9">) | (aValue &amp; </span><span style="line-height: 14px; " class="style_11">0x0fff</span><span style="line-height: 14px; " class="style_9">);<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">                    }<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">                }<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">                </span><span style="line-height: 14px; " class="style_10">else</span><span style="line-height: 14px; " class="style_9"> </span><span style="line-height: 14px; " class="style_10">if</span><span style="line-height: 14px; " class="style_9"> (result &lt; </span><span style="line-height: 14px; " class="style_11">0</span><span style="line-height: 14px; " class="style_9">)LogBusError(</span><span style="line-height: 14px; " class="style_13">&quot;Rd Err: Shaper 0x%04x %s&quot;</span><span style="line-height: 14px; " class="style_9">,baseAddress,strerror(errno));                <br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">            }<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">        }<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">    }<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">    </span><span style="line-height: 14px; " class="style_10">else</span><span style="line-height: 14px; " class="style_9"> </span><span style="line-height: 14px; " class="style_10">if</span><span style="line-height: 14px; " class="style_9"> (result &lt; </span><span style="line-height: 14px; " class="style_11">0</span><span style="line-height: 14px; " class="style_9">)LogBusError(</span><span style="line-height: 14px; " class="style_13">&quot;Rd Err: Shaper 0x%04x %s&quot;</span><span style="line-height: 14px; " class="style_9">,baseAddress,strerror(errno));                <br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9"><br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">    </span><span style="line-height: 14px; " class="style_10">return</span><span style="line-height: 14px; " class="style_9"> config-&gt;card_info[index].next_Card_Index;<br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9">}            <br /></span></p>
                <p class="paragraph_style_11"><span style="line-height: 14px; " class="style_9"><br /></span></p>
              </div>
            </div>
          </div>
          


          <div id="id45" style="height: 70px; left: 3px; position: absolute; top: 2739px; width: 669px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_669_70" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="Body">Each read out routine then uses calls to the local SBC hardware driver to determine if an event needs to be read out and then assembles that event into a data structure that ORCA expects. As an example, here is the read out routine for the VME CENPA shaper card:</p>
              </div>
            </div>
          </div>
          


          <div id="id46" style="height: 67px; left: 546px; position: absolute; top: 2958px; width: 110px; z-index: 1; " class="style_SkipStroke_4 shape-with-text stroke_14">
            <div class="text-content graphic_textbox_layout_style_default_External_108_65" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_13">The dataID and other device specific info is in the config structure</p>
              </div>
            </div>
          </div>
          


          <div id="id47" style="height: 24px; left: 226px; position: absolute; top: 2886px; width: 344px; z-index: 1; " class="style_SkipStroke_4 shape-with-text stroke_15">
            <div class="text-content graphic_textbox_layout_style_default_External_342_22" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_13">Use the device driver to determine if an event is ready to be read out</p>
              </div>
            </div>
          </div>
          


          <div id="id48" style="height: 38px; left: 485px; position: absolute; top: 3164px; width: 184px; z-index: 1; " class="style_SkipStroke_4 shape-with-text stroke_16">
            <div class="text-content graphic_textbox_layout_style_default_External_182_36" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_13">The data record needs to be the ORCA specified format</p>
              </div>
            </div>
          </div>
          


          <div id="id49" style="height: 24px; left: 458px; position: absolute; top: 3382px; width: 184px; z-index: 1; " class="style_SkipStroke_4 shape-with-text stroke_17">
            <div class="text-content graphic_textbox_layout_style_default_External_182_22" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_13">Always return the next_Card_Index</p>
              </div>
            </div>
          </div>
          


          <div id="id50" style="height: 81px; left: 528px; position: absolute; top: 3050px; width: 146px; z-index: 1; " class="style_SkipStroke_4 shape-with-text stroke_18">
            <div class="text-content graphic_textbox_layout_style_default_External_144_79" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_13">If this card was to read out children based on a trigger, you’d make a call back to readHW() with the child’s index.</p>
              </div>
            </div>
          </div>
          


          <div id="id51" style="height: 67px; left: 110px; position: absolute; top: 3427px; width: 267px; z-index: 1; " class="style_SkipStroke_4 shape-with-text stroke_19">
            <div class="text-content graphic_textbox_layout_style_default_External_265_65" style="padding: 1px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_13">Note that the data is just put into the array data[] and the dataIndex is incremented as needed. The actual shipping of the data record into the circular buffer is done automatically.</p>
              </div>
            </div>
          </div>
          


          <div id="id52" style="height: 843px; left: 7px; position: absolute; top: 3570px; width: 683px; z-index: 1; " class="style_SkipStroke_2 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_683_843" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Body"><span class="style_2">Sharing the network between the Mac and the SBC<br /></span></p>
                <p class="Body"><br /></p>
                <p class="Body">These instructions describe how to share a network connection between a Mac equipped with dual ethernet ports and a Single Board Computer (SBC) running Crux version 2.4.  It is assumed that the Ethernet 1 port on the Mac is already configured for use on a local network.  The SBC should be connected to the Mac's Ethernet 2 port (<span class="style_8">note that it is not necessary to use an Ethernet crossover cable to connect the Mac to another Ethernet device</span>).<br /></p>
                <p class="Body"><br /></p>
                <p class="Body">From the apple menu select System Preferences -&gt; Network.<br /></p>
                <p class="Body"><br /></p>
                <p class="Body">Select Ethernet 2 and in the Configure: field choose Manually from the drop down menu.<br /></p>
                <p class="Body"><br /></p>
                <p class="Body">Modify the following fields.<br /></p>
                <p class="Body"><br /></p>
                <p class="Body">IP Address: $$$.$$$.$$$.$$$  this will be the gateway address for the SBC (e.g. 10.0.0.1)<br /></p>
                <p class="Body">Subnet Mask: 255.255.255.0<br /></p>
                <p class="Body">Router: $$$.$$$.$$$.$$$<br /></p>
                <p class="Body"><br /></p>
                <p class="Body">The remaining fields should remain blank.<br /></p>
                <p class="Body"><br /></p>
                <p class="Body">Now open System Preferences -&gt; Sharing.  In the Internet Sharing pane choose to share your connection from Ethernet 1 to computers using Ethernet 2.  Turn on Internet Sharing by clicking the check box next to Internet Sharing.  A green dot will appear alerting you that Internet Sharing is enabled.<br /></p>
                <p class="Body"><br /></p>
                <p class="Body">Log in to the SBC as root.<br /></p>
                <p class="Body"><br /></p>
                <p class="Body">Modify /etc/rc.d/net.  Change the lines that look like:<br /></p>
                <p class="Body">...<br /></p>
                <p class="Body">/sbin/ip addr add ###.###.##.###/24 dev eth0 broadcast +<br /></p>
                <p class="Body">...<br /></p>
                <p class="Body">/sbin/ip route add default via $$$.$$$.$$$.$$$<br /></p>
                <p class="Body">...<br /></p>
                <p class="Body">/sbin/ip addr del ###.###.###.###/24 dev eth0<br /></p>
                <p class="Body"><br /></p>
                <p class="Body">replacing ###.###.###.### with the desired SBC IP address and replacing $$$.$$$.$$$.$$$ with the IP address assigned to the Ethernet 2 port on the Mac.<br /></p>
                <p class="Body"><br /></p>
                <p class="Body">Restart the network service by typing<br /></p>
                <p class="Body"><br /></p>
                <p style="padding-bottom: 0pt; " class="Body">/etc/rc.d/net restart</p>
              </div>
            </div>
          </div>
          <div style="height: 4413px; line-height: 4413px; " class="spacer"> </div>
        </div>
        <div style="height: 150px; margin-left: 0px; position: relative; width: 700px; z-index: 15; " id="footer_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
        </div>
      </div>
    </div>
  </body>
</html>


